function setListId(a,b){PDF_close(a);}var pre_satisfaction="很不满意\n不满意\n一般\n满意\n很满意";var pre_agree="很不同意\n不同意\n一般\n同意\n很同意";var pre_import="很不重要\n不重要\n一般\n重要\n很重要";var pre_accord="很不符合\n不符合\n一般\n符合\n很符合";var pre_wanting="很不愿意\n不愿意\n一般\n愿意\n很愿意";var pre_bool_1="是\n否";var pre_bool_2="对\n错";var pre_bool_3="满意\n不满意";var pre_bool_4="同意\n不同意";var pre_bool_5="正确\n错误";var pre_bool_6="支持\n反对";var pre_bool_7="Ture\nFalse";var pre_bool_8="Yes\nNo";var currentRelation="";var itemImage="";function setFloat(a){a.className="spanLeft";}function getEditorIndex(){return EditorIndex++;}function getVerifyHtml(f){var b="验证：<select onchange='cur.setVerify(this);'>";var e=["0,无","数字,整数","小数","日期","手机","固话","电话,手机或固话","Email,邮件","城市单选,省份城市","省市区","高校","指定选项","网址","身份证号","QQ","汉字","英文"];for(var d=0;d<e.length;d++){var g=e[d];var h=g.split(",");var a=h[0];var c=h.length==2?h[1]:h[0];if(g=="指定选项"&&f==0){continue;}b+="<option value='"+a+"'>"+c+"</option>";}b+="</select>";return b;}function checkVerifyMinMax(d,a,e){var b=d.value;var c=a.value;if(b&&!isInt(b)){return"您输入的数据不正确";}if(c&&!isInt(b)){return"您输入的数据不正确";}if(b&&c&&b-c>0){return"您输入的数据不正确";}if(e=="数字"||e=="小数"){return"";}if(b&&b-3000>0){return"字数不能超过3000";}if(c&&c-3000>0){return"字数不能超过3000";}return"";}function createAttr(){var ai=new Date().getTime();var d4;var B=document.createElement("div");this.appendChild(B);var aF=document.createDocumentFragment();this.tabAttr=B;var cA=this;var m=this.dataNode;var cx=m._type;var cW=this.dataNode._tag||0;var cH=cx=="question";var ci=cx=="slider";var u=cx=="sum";var bv=cx=="page";var F=cx=="cut";var bo=cx=="check";var aI=cx=="radio";var aX=aI&&cW;var cU=cx=="radio_down";var ar=cx=="matrix";var b0=cx=="matrix"&&cW>300;var d5=cx=="fileupload";var dY=cx=="gapfill";var dS=bo&&cW;var dW=aI||cU||bo||ar;var ef=!F&&!bv;var dy=m._verify||"0";var a3=dy!="0";var bF=m._isTouPiao;var bR=m._isCeShi;var M=m._isQingJing;var cS=m._isShop;var ee=m._isCePing;var az=ar&&cW<102;var aa=this.get_div_title();var dM="";var cZ=new Array();this.option_radio=cZ;var aB=document.createElement("div");aB.className="div_title_attr_question";if(bR&&!dY){this.addCeShiSetting=function(es){var en=$ce("div","",es);en.style.marginTop="15px";var eq=$ce("span","<b>题目分数：</b>",en);var ep="<select onchange='cur.setTValue(this.value);'>";for(var em=1;em<=50;em++){ep+="<option value='"+em+"'>"+em+"</option>";}ep+="</select>&nbsp;";eq.innerHTML+=ep;this.setTValue=function(i){cA.dataNode._ceshiValue=parseInt(i);dw.style.display="";if(cH){cA.setCeshiQTip();}else{cA.spanCeShi.innerHTML="（分值："+cA.dataNode._ceshiValue+"分）";}};this.initValue=function(){if(this.dataNode._ceshiValue){var i=$$("select",eq)[0];i.value=this.dataNode._ceshiValue;}};en.appendChild(eq);var dw=$ce("span","<a onclick='cur.copyScore(this);' class='titlelnk' href='javascript:'>复制分数</a>",en);dw.style.display="none";this.copyScore=function(i){PDF_launch("/wjx/design/applyscore.aspx?ct="+cA.dataNode._topic,500,240,null,"批量复制分数");};if(cH){var er=$ce("span","&nbsp;答案：",en);var eo=control_text("14");er.appendChild(eo);$ce("span","<a title='如果有多个答案，请以“|”分隔' href='javascript:void(0);'  onclick='alert(this.title);' style='color:green;'><b>(?)</b></a>&nbsp;&nbsp;",er);eo.value=m._answer;eo.onfocus=function(){if(this.value=="请设置答案"){this.value="";}};eo.onchange=eo.onblur=function(){if(this.value==""){this.value="请设置答案";}cA.dataNode._answer=this.value;cA.setCeshiQTip();};eo.onchange();var j=control_check();er.appendChild(j);$ce("span","<b>包含答案即可得分</b><a title='用户提交的答案不需要跟设置的答案完全一样，只要包含设置的答案就可得分。' href='javascript:void(0);' onclick='alert(this.title);' style='color:green;'><b>(?)</b></a>",er);j.onclick=function(){if(!vipUser){alert("此功能只对企业版用户开放，请升级！");this.checked=false;return;}cA.dataNode._include=this.checked;};j.checked=m._include;if(eo.value=="简答题无答案"){er.style.display="none";}}var el=$ce("span","&nbsp;&nbsp;答案解析<a title='您可以填写针对此题答案的一些解析说明，在用户参与完测试后会看到此解析' href='javascript:void;' onclick='alert(this.title);' style='color:green;'><b>(?)</b></a>：",en);var ek=control_text("14");el.appendChild(ek);ek.value=m._ceshiDesc;ek.onchange=ek.onblur=function(){cA.dataNode._ceshiDesc=this.value;};ek.onchange();ek.style.display="none";$ce("span","&nbsp;",en);var et=$ce("a","设置答案解析",en);et.href="javascript:void(0)";et.className="link-U666";et.onclick=function(){if(!vipUser){alert("此功能只对企业版用户开放，请升级！");return;}openTitleEditor(ek,function(i){if(i=="-1nc"||i==undefined){return;}ek.value=trim(i);ek.onchange();});};this.initValue();};}var c2=document.createElement("div");c2.style.marginLeft="15px";var ad=m._title=="请在此输入问题标题"||m._title=="请根据您的实际情况选择最符合的项：1-->5表示非常不满意-->非常满意";var cl=$ce("div","",c2);if(M){c2.style.display="none";}var c=m._title.indexOf("<")>-1;if(!c){var ab=$ce("div","<span style='float:left;'>&nbsp;<b style='font-size:14px;'>题目标题</b></span>",cl);ab.style.background="#F0F0EE";ab.style.height="27px";ab.style.lineHeight="27px";ab.style.width="400px";var bB=$ce("span","",ab);bB.className="spanRight";var d9=$ce("a","设置标题字体、插入图片视频",bB);d9.href="javascript:void(0);";d9.className="link-U666";d9.onclick=function(){cA.createEditBox();};var bO=$ce("a","<b>(?)</b>",bB);bO.style.color="green";bO.href="javascript:void(0);";bO.onmouseover=function(){toolTipLayer.style.width="400px";toolTipLayer.innerHTML='<img width="400" height="152" src="/Images/Mysojump/QuestionnaireMng/Design/edit_pic.jpg">';sb_setmenunav(toolTipLayer,true,this);};bO.onmouseout=function(){sb_setmenunav(toolTipLayer,false,this);};$ce("div","",ab).className="divclear";}var br=$ce("div","",cl);var dV=$ce("div","",br);br.style.width="395px";var G=control_textarea("4","29");G.tabIndex=1;if(ad){G.defValue=m._title;}if(ef){G.title="例如：您最喜欢的车型？";G.value=m.title;}if(bv){G.title="您可以在此输入本页的页面标题信息（选填）";}if(F){G.title="请在此输入内容";G.value=m.title;var c9=$ce("div","<a href='javascript:'>插入视频</a>(支持手机与电脑播放)<a href='/help/help.aspx?helpid=229' style='color:green;font-weight:bold;' target='_blank'>(?)</a>",cl);c9.style.marginTop="10px";var bl=$$("a",c9)[0];var t=control_text("50");var dJ=$ce("div","",cl);dJ.style.marginTop="5px";dJ.appendChild(t);bl.onclick=function(){t.style.display=t.style.display=="none"?"":"none";};t.value=m._video||"";t.style.display=m._video?"":"none";t.onchange=function(){var dw=this.value;var j=/(https?:\/\/[^\s\"\']+)/g;var i=dw.match(j)||"";this.value=i;cA.dataNode._video=i;cA.checkTitle();};}var w="tc"+m._type+getEditorIndex();G.value=m._title;G.id=w;G.style.overflow="auto";G.style.padding="5px 0 0 5px";G.style.border="1px solid #ccc";dV.appendChild(G);if(ef){G.style.width="395px";if(!c){G.style.height="70px";}else{G.style.height="102px";}}else{G.style.width="395px";G.style.height="130px";}G.onkeyup=G.onchange=function(){cA.checkTitle();};G.onfocus=function(){if(this.value=="请在此输入问题标题"||this.value=="请根据您的实际情况选择最符合的项：1-->5表示非常不满意-->非常满意"){this.value="";}};G.onblur=function(){if(!this.value&&cA.dataNode._type!="page"){this.value=this.defValue||"";cA.checkTitle();}};var bJ="";if(bF){if(aI){bJ="<option value='radio'>列表单选题</option><option value='toupiaocheck'>投票多选题</option>";}else{if(bo){if(!isMergeAnswer||this.isMergeNewAdded){bJ="<option value='toupiaoradio'>投票单选题</option><option value='check'>多选题</option>";}else{bJ="<option value='check'>多选题</option>";}}}}else{if(bR){if(aI){bJ="<option value='radio'>列表单选题</option><option value='ceshicheck'>考试多选题</option>";}else{if(bo){if(!isMergeAnswer||this.isMergeNewAdded){bJ="<option value='ceshiradio'>考试单选题</option><option value='check'>多选题</option>";}else{bJ="<option value='check'>多选题</option>";}}}}else{if(ee){if(aI){bJ="<option value='radio'>列表单选题</option><option value='cepingcheck'>评分多选题</option>";}else{if(bo){if(!isMergeAnswer||this.isMergeNewAdded){bJ="<option value='cepingradio'>评分单选题</option><option value='check'>列表多选题</option>";}else{bJ="<option value='check'>列表多选题</option>";}}}}else{if(!isMergeAnswer||this.isMergeNewAdded){if(cH){bJ="<option value='radio'>列表单选题</option><option value='radio_down'>下拉框单选题</option><option value='check'>多选题</option><option value='likert'>量表题</option><option value='order'>排序题</option>";}else{if(ar){if(b0){if(cW!=303){bJ+="<option value='matrix,303'>表格下拉框</option>";}if(cW!=301){bJ+="<option value='matrix,301'>表格数值题</option>";}if(cW!=302){bJ+="<option value='matrix,302'>表格文本框</option>";}}else{if(cW<=101){bJ+="<option value='matrix,103'>矩阵单选题</option>";bJ+="<option value='matrix,102'>矩阵多选题</option>";bJ+="<option value='matrix,201'>矩阵文本题</option>";bJ+="<option value='matrix,202'>矩阵滑动条</option>";}else{bJ+="<option value='matrix,101'>矩阵量表题</option>";if(cW!=103){bJ+="<option value='matrix,103'>矩阵单选题</option>";}if(cW!=102){bJ+="<option value='matrix,102'>矩阵多选题</option>";}if(cW!=201){bJ+="<option value='matrix,201'>矩阵文本题</option>";}if(cW!=202){bJ+="<option value='matrix,202'>矩阵滑动条</option>";}}}}else{if(dW){if(!aI||aX){bJ+="<option value='radio'>列表单选题</option>";}if(!cU){bJ+="<option value='radio_down'>下拉框单选题</option>";}if(!bo||dS){bJ+="<option value='check'>多选题</option>";}if(!aX){bJ+="<option value='likert'>量表题</option>";}if(!dS){bJ+="<option value='order'>排序题</option>";}if(aI){bJ+="<option value='toupiaoradio'>投票单选题</option>";bJ+="<option value='ceshiradio'>考试单选题</option>";bJ+="<option value='cepingradio'>评分单选题</option>";}else{if(bo&&!dS){bJ+="<option value='toupiaocheck'>投票多选题</option>";bJ+="<option value='ceshicheck'>考试多选题</option>";}}bJ+="<option value='question'>问答题</option>";}}}}else{if((aI||cU)&&cW==0){bJ="<option value='likert'>量表题</option><option value='check'>多选题</option><option value='toupiaoradio'>投票单选题</option><option value='cepingradio'>评分单选题</option><option value='ceshiradio'>考试单选题</option>";}else{if(bo&&!dS){bJ="<option value='toupiaocheck'>投票多选题</option>";bJ+="<option value='ceshicheck'>考试多选题</option>";}}}}}}if(bJ){bJ="<select style='width:90px;' onchange='javascript:cur.selChangeType(this.value);'><option value='0'>转换题型</option>"+bJ+"</select>";}if(ef||F){var dO=$ce("div","",c2);}if(ef){setFloat(cl);if(cS){dO.style.display="none";}this.getQType=function(){var i=cA.dataNode._type;if(i=="question"){return"文本题";}else{if(i=="gapfill"){return"填空题";}else{if(i=="radio"){if(cA.dataNode._isTouPiao){return"投票单选题";}else{if(cA.dataNode._isCeShi){return"考试单选题";}else{if(cA.dataNode._isCePing){return"评分单选题";}else{if(cW){return"量表题";}else{if(cA.dataNode._isQingJing){return"情景随机题";}}}}}return"单选题";}else{if(i=="radio_down"){return"下拉框单选";}else{if(i=="check"){if(cA.dataNode._isTouPiao){return"投票多选题";}else{if(cA.dataNode._isCeShi){return"考试多选题";}else{if(cA.dataNode._isCePing){return"评分多选题";}else{if(cW){return"排序题";}}}}return"多选题";}else{if(i=="fileupload"){return"上传文件题";}else{if(i=="matrix"){if(cW==201){return"矩阵文本题";}else{if(cW==202){return"矩阵滑动条";}else{if(cW==301){return"表格数值题";}else{if(cW==302){return"表格文本题";}else{if(cW==303){return"表格下拉框";}else{if(az){return"矩阵量表题";}else{if(cW==103){return"矩阵单选题";}else{if(cW==102){return"矩阵多选题";}}}}}}}}}else{if(i=="sum"){return"比重题";}}}}}}}}return"";};setFloat(dO);if(bJ){var ay=$ce("div","",dO);var aV=this.getQType();var be=aV;if(aV){aV="&nbsp;&nbsp;当前题型：<b>"+aV+"</b>";}ay.innerHTML=aV+"&nbsp;&nbsp;"+bJ;this.selChangeType=function(j,i){if(j=="0"){return;}if(j=="question"){if(confirm("转换成问答题将丢失所有选项信息，是否继续？")==false){return;}}changeQ(j);window.focus();};if(be=="考试单选题"||be=="评分单选题"||be=="量表题"){var am=false;var bN=0;var bc=cA.dataNode._topic;for(var dG=0;dG<questionHolder.length;dG++){var I=questionHolder[dG].dataNode;var af=I._type;if(af=="cut"||af=="page"){continue;}var d4=I._topic;if(d4-bc<=0){continue;}if(I._type!="radio"){break;}bN++;}if(bN>=2){am=true;}if(am){var E=$ce("span","&nbsp;&nbsp;<a href='javascript:void(0);' class='link-U00a6e6' title='批量复制此题的题型到后面的题目'>批量复制</a>",ay);E.onclick=function(){var i="/wjx/design/applyqtype.aspx";var j=cA.dataNode._topic;i+="?ct="+j;PDF_launch(i,500,240,null,"批量复制此题的题型到后面的题目");};}}}var d6=$ce("div","",dO);d6.innerHTML="&nbsp;&nbsp;";var l=control_check();l.title="用户在填写问卷时必须回答这道题";var ds=document.createTextNode("必答题");d6.appendChild(l);d6.appendChild(ds);var W=document.createElement("span");W.style.display="none";W.innerHTML="&nbsp;&nbsp;&nbsp;&nbsp;将所有题目设为：<b><a href='javascript:setAllRequired(true);' class='link-U00a6e6'>必答</b></a>&nbsp;<a href='javascript:setAllRequired(false);' class='link-U00a6e6'><b>非必答</b></a>";d6.appendChild(W);l.onclick=function(){cA.dataNode._requir=this.checked;cA.setreqstatus();W.style.display="";};this.get_requir=function(){return l;};var e=document.createElement("div");e.innerHTML="&nbsp;&nbsp;";var aA=control_check();e.appendChild(aA);var bp=document.createTextNode("填写提示");e.appendChild(bp);var cN=$ce("span","&nbsp;",e);var d1=control_text("15");cN.appendChild(d1);$ce("span","&nbsp;",cN);var V=$ce("a","高级编辑模式",cN);V.href="javascript:void(0)";cN.style.display="none";var bk=false;aA.onclick=function(){cN.style.display=this.checked?"":"none";if(!this.checked){cA.dataNode._oldins=d1.value;d1.value="";}else{d1.value=cA.dataNode._oldins||"";}d1.onchange();};V.onclick=function(){openTitleEditor(d1,function(i){if(i=="-1nc"||i==undefined){return;}d1.value=trim(i);d1.onchange();});};d1.onchange=d1.onblur=function(){this.value=replace_specialChar(this.value);if(d1.value.length>0){cA.get_div_ins().innerHTML=subjectInfo+this.value;cA.get_div_ins().style.visibility="visible";}else{cA.get_div_ins().style.visibility="hidden";}cA.dataNode._ins=this.value;if(this.value.indexOf("<")>-1){this.style.display="none";V.innerHTML="编辑填写提示";}else{this.style.display="";V.innerHTML="高级编辑模式";}if(cA.checkTextJump){cA.checkTextJump(this.value);}};dO.appendChild(e);var a9=$ce("div","",dO);a9.innerHTML="&nbsp;&nbsp;";var bU=control_check();var ch=document.createTextNode("无条件跳题");var cY=document.createElement("span");cY.style.display="none";var cg=document.createElement("span");cg.innerHTML="，填写此题后跳转到第";var bE=control_text("3");bE.onclick=function(){openJumpWindow(cA,this,true);bE.openJumped=true;};bE.onmouseout=function(){sb_setmenunav(toolTipLayer,false);};bE.onmouseover=function(){if(!this.error){if(!this.title||this.hasChanged){this.title=getJumpTitle(this.value);}}};var cf=document.createElement("span");cf.innerHTML="题";cY.appendChild(cg);cY.appendChild(bE);cY.appendChild(cf);a9.appendChild(bU);a9.appendChild(ch);a9.appendChild(cY);var bW=$ce("a","<b>(?)</b>",a9);bW.style.color="green";bW.href="javascript:void(0);";bW.onmouseover=function(){toolTipLayer.style.width="250px";toolTipLayer.innerHTML="通过配合设置其他题目的“按选项跳题”实现更复杂的跳题逻辑 <a target='_blank' class='link-U00a6e6' href='/help/help.aspx?helpid=218&h=1'>查看示例</a>";sb_setmenunav(toolTipLayer,true,this);};bW.onmouseout=function(){sb_setmenunav(toolTipLayer,false,this);};bU.onclick=function(){if(this.checked){if(bQ&&bQ.value!=""){if(confirm("设置跳转逻辑将清空本题的默认值，是否继续？")){bQ.value="";cA.dataNode._default="";bZ.value="";}else{this.checked=false;}}if(c0&&c0.checked){c0.click();}if(!l.checked){show_status_tip("由于设置了无条件跳题，建议将此题设为必答",4000);}}if(cA.defaultCheckSet){cA.defaultCheckSet();}if(bQ){bQ.disabled=this.checked;}cY.style.display=this.checked?"":"none";cA.dataNode._anytimejumpto=cA.dataNode._anytimejumpto=="0"?"":cA.dataNode._anytimejumpto;if(this.checked&&cA.dataNode._anytimejumpto){cA.dataNode._hasjump=true;}else{if(!this.checked){cA.dataNode._hasjump=false;}}cA.set_jump_ins();bE.value=cA.dataNode._anytimejumpto;};bE.onblur=function(){if(this.value==this.prevValue){this.hasChanged=false;return;}this.hasChanged=true;this.prevValue=this.value;cA.checkAnyJump(true);cA.set_jump_ins();};$ce("div","",c2).style.clear="both";}if(ef||F){var k=$ce("div","",dO);if(!F){k.innerHTML="&nbsp;&nbsp;";}var cw=control_check();var b2=document.createElement("span");b2.innerHTML="<b>关联逻辑</b>：<span style='color:#666;'>当前面题目选中某些选项时才出现此题</span>";var ed=document.createElement("span");var a7=document.createElement("a");a7.innerHTML="设置关联逻辑";a7.href="javascript:void(0);";function aL(){cur.dataNode._relation=currentRelation||"";cur.displayRelation();}ed.appendChild(a7);cA.initRelation=function(){this.dataNode._relation="";a7.innerHTML="设置关联逻辑";cw.checked=false;if(cA.RelationIns){cA.RelationIns.style.display="none";}ed.style.display="none";b2.style.display="";if(bA){bA.style.display="none";}};cA.displayRelation=function(){var j=this.dataNode._relation;if(!j){this.initRelation();return;}else{if(j=="0"){cw.checked=true;return;}}cw.checked=true;var i=this.getRelation();if(i){a7.innerHTML=i[0];a7.title=i[1];cA.RelationIns.innerHTML=i[0];cA.RelationIns.title=i[1];cA.RelationIns.style.display="";b2.style.display="none";ed.style.display="";if(!F){bA.style.display="";}bA.onclick=function(){var ek="/wjx/design/applyrelation.aspx";var el=cA.dataNode._topic;ek+="?ct="+el;var dw=cA.dataNode._relation;if(dw){ek+="&rt="+dw;}PDF_launch(ek,500,320);};}};a7.onclick=function(){var j="/wjx/design/setrelation.aspx";var dw=cA.dataNode._topic;if(F){dw="0";}if(dw=="1"){show_status_tip("第1题不能设置关联逻辑",5000);cw.checked=false;return;}j+="?ct="+dw;var i=cA.dataNode._relation;if(i){j+="&rt="+i;}currentRelation=i||"";PDF_launch(j,500,320,aL);};cw.onclick=function(){if(!this.checked){cA.initRelation();return;}else{a7.onclick();}};k.appendChild(cw);k.appendChild(b2);k.appendChild(ed);var bt=$ce("span","<a href='/help/help.aspx?helpid=216&h=1' target='_blank' style='color:green;'><b>(?)</b></a>",k);var bA=$ce("span","&nbsp;&nbsp;<a href='javascript:void(0);' class='link-U00a6e6'>复制到后面的题目</a>",k);bA.style.display="none";this.displayRelation();}if(dY){var cP=$ce("div","",dO);cP.style.marginLeft="13px";var dm=control_check();cP.appendChild(dm);dm.onclick=function(){cA.dataNode._useTextBox=this.checked;cA.checkTitle();};$ce("span","文本框样式&nbsp;&nbsp;",cP);var U=document.createElement("a");U.innerHTML="<b>插入填空</b>";U.className="link-U00a6e6";U.href="javascript:void(0);";U.title="填空用连续超过三个的下划线'_ _ _'表示";U.onclick=function(){if(KE.g[w].wyswygMode){KE.util.focus(w);KE.util.selection(w);KE.util.insertHtml(w,GapFillStr);KE.util.focus(w);}};cP.appendChild(U);}aB.appendChild(c2);aF.appendChild(aB);if(bv){var dr=document.createElement("span");dr.innerHTML="此页是否是甄别页：";dr.title="可以在此页设置筛选规则，如果用户提交的答卷不符合要求，则会终止后面的答题";var s=control_check();s.title=dr.title;s.onclick=function(){cA.dataNode._iszhenbie=this.checked;cA.divZhenBie.style.display=this.checked?"":"none";};c2.appendChild(dr);c2.appendChild(s);var d2=$ce("a","(?)",c2);d2.href="javascript:void(0);";d2.style.color="green";d2.style.fontWeight="bold";d2.onmouseover=function(){toolTipLayer.style.width="250px";toolTipLayer.innerHTML="可以对此页的题目设置无效答卷筛选规则，用户点击下一页时，如果此页的答题不符合要求，系统会终止该用户继续答题。<a href='/help/help.aspx?helpid=76' target='_blank'>如何设置筛选规则？</a>";sb_setmenunav(toolTipLayer,true,this);};d2.onmouseout=function(i){sb_setmenunav(toolTipLayer,false,this);};var bD=!vipUser&&!window.isPromote;if(bD){dr.style.display=s.style.display=d2.style.display="none";}var ae=document.createElement("div");ae.style.margin="10px 0 0 15px";aB.appendChild(ae);var cX=document.createElement("div");cX.style.margin="10px 0 0 15px";$ce("span","<b>填写时间控制</b>&nbsp;",cX);aB.appendChild(cX);var bn=control_text(3);$ce("span","此页允许停留时间为：<b>最短</b>",cX).appendChild(bn);var dz=control_text(3);var f=$ce("span","秒&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>最长</b>",cX);f.appendChild(dz);$ce("span","秒（空表示不限制）",cX);bn.parDiv=cA;bn.onblur=bn.onchange=function(){var dw=this;var ek=dw.value;var j=this.parDiv;var el=j.dataNode._maxtime;j.dataNode._istimer=false;if(ek){if(isPositive(ek)&&(!el||(ek-el<=0))){if(el&&ek-el==0){j.dataNode._istimer=true;}j.dataNode._mintime=parseInt(ek);}else{show_status_tip("最短时间必须为正整数并且少于最长时间",4000);dw.value="";j.dataNode._mintime="";}}else{j.dataNode._mintime="";}var i=j.dataNode._mintime||j.dataNode._maxtime;cb.style.display=(window.isPromote||vipUser)&&i?"":"none";j.showTimeLimit();};bn.onclick=function(){if(!vipUser){alert("只有企业版用户才能设置每页最短填写时间，请升级！");this.value="";this.blur();return;}};dz.onclick=function(){if(!vipUser){alert("只有企业版用户才能设置每页最长填写时间，请升级！");this.value="";this.blur();return;}};dz.onblur=dz.onchange=function(){var dw=this;var ek=dw.value;var j=cur.dataNode._mintime;cur.dataNode._istimer=false;if(ek){if(isPositive(ek)&&(!j||(ek-j>=0))){if(j&&ek-j==0){cur.dataNode._istimer=true;}cur.dataNode._maxtime=parseInt(ek);}else{show_status_tip("最长时间必须为正整数并且大于最短时间",4000);dw.value="";}}else{cur.dataNode._maxtime="";}var i=cur.dataNode._mintime||cur.dataNode._maxtime;cb.style.display=(window.isPromote||vipUser)&&i?"":"none";cA.showTimeLimit();};cA.setMinMaxTime=function(){if(bn){bn.value=this.dataNode._mintime;}if(dz){dz.value=this.dataNode._maxtime;}};var ck=$ce("a","(?)",cX);ck.href="javascript:void(0);";ck.style.color="green";ck.style.fontWeight="bold";ck.onmouseover=function(){toolTipLayer.style.width="250px";toolTipLayer.innerHTML="说明：从进入此页开始计时，在还未达到最短填写时间时不能进入下一页或提交答卷，当到达最长填写时间后还未做答完成将自动跳转到下一页或提交答卷。如果要控制用户观看图片或者视频的时间，可以设置最短填写时间等于最长填写时间，<a href='http://www.sojump.com/jq/3690298.aspx' target='_blank' class='titlelnk'>查看示例问卷</a>";sb_setmenunav(toolTipLayer,true,this);};ck.onmouseout=function(i){sb_setmenunav(toolTipLayer,false,this);};var cb=$ce("div","将上面的填写时间复制到&nbsp;",cX);cb.style.marginLeft="83px";var ap=1;var x=1;var Z=total_page;$ce("span","<input type='radio'  name='rbltimesp' onclick='cur.setTimePageTime(1);'  checked='checked'  />所有页<input type='radio' name='rbltimesp'  onclick='cur.setTimePageTime(2);'/>指定页",cb);var L=$ce("span","：第<input type='text' value='1' onblur='cur.setTimePageStart(this);' style='width:20px;'/>页到<input type='text' value='"+Z+"' onblur='cur.setTimePageEnd(this);' style='width:20px;'/>页",cb);L.style.display="none";cA.setTimePageTime=function(i){ap=i;L.style.display=i==1?"none":"";};cA.setTimePageStart=function(i){var j=i.value;if(!isPositive(j)||j-Z>=0){i.value=1;show_status_tip("必须为正数，并且小于最大页数",4000);}x=i.value;};cA.setTimePageEnd=function(i){var j=i.value;if(!isPositive(j)||j-total_page>0){i.value=total_page;show_status_tip("必须为正数，并且小于总页数",4000);}else{if(j-x<=0){i.value=total_page;show_status_tip("必须大于最小页数",4000);}}Z=i.value;};var ea=$ce("span","&nbsp;",cb);var aH=control_btn("复制");aH.className="operation";ea.appendChild(aH);aH.onclick=function(){if(ap==1){Z=total_page;}dt(firstPage);for(var j=0;j<questionHolder.length;j++){dt(questionHolder[j]);}show_status_tip("成功复制",4000);};var c7=$ce("div","",aB);c7.style.margin="10px 0px 0px 15px";if(!vipUser&&!window.isPromote){c7.style.display="none";}$ce("span","<b>批量插入分页符</b>&nbsp;",c7);var ei=$ce("span","每隔",c7);var ba=control_text(3);ba.value="1";ei.appendChild(ba);$ce("span","题插入一个分页符",ei);ba.maxlength=2;ba.onblur=ba.onchange=function(){if(!isPositive(this.value)){this.value=1;}};var db=1;var a1=1;var dn=total_question;$ce("span","&nbsp;&nbsp;&nbsp;应用范围：<input type='radio' name='rblPageScope' onclick='cur.setInsertScopeType(1);' checked='checked'/>全部题<input type='radio' name='rblPageScope' onclick='cur.setInsertScopeType(2);'/>指定题",c7);var n=$ce("span","&nbsp;第<input type='text' style='width:20px;' value='1' onblur='cur.setInsertMinPage(this);'>题至第<input type='text' style='width:20px;'  onblur='cur.setInsertMaxPage(this);' value='"+dn+"'>题",c7);n.style.display="none";cA.setInsertScopeType=function(i){db=i;n.style.display=i==1?"none":"";};cA.setInsertMinPage=function(i){var j=i.value;if(!isPositive(j)||j-dn>=0){i.value=1;show_status_tip("必须为正数，并且小于最大题数",4000);}a1=i.value;};cA.setInsertMaxPage=function(i){var j=i.value;if(!isPositive(j)||j-total_question>0){i.value=total_question;show_status_tip("必须为正数，并且小于总题数",4000);}else{if(j-a1<=0){i.value=total_question;show_status_tip("必须大于最小题数",4000);}}dn=i.value;};var ej=$ce("span","",c7);var S=control_btn("批量插入");S.className="operation";ej.appendChild(S);$ce("span","&nbsp;",ej);var cc=control_btn("删除");cc.className="operation";cc.title="删除除第一页之外的所有分页";ej.appendChild(cc);cc.onclick=function(){if(confirm("确定删除除第一页之外的所有分页吗？")){var ek=new Array();for(var j=0;j<questionHolder.length;j++){var dw=questionHolder[j].dataNode;if(dw._type=="page"){ek.push(questionHolder[j]);}}for(var j=0;j<ek.length;j++){ek[j].deleteQ("noNeedConfirm");}}};S.onclick=function(){var em=new Array();for(var el=0;el<questionHolder.length;el++){var eo=questionHolder[el].dataNode;questionHolder[el].pageNext=false;if(eo._type!="page"&&eo._type!="cut"){em.push(questionHolder[el]);}else{if(eo._type=="page"){if(el>0){questionHolder[el-1].pageNext=true;}}}}var j=em.length;if(j>1){var dw=parseInt(ba.value);var ep=(a1-1)||dw-1;if(db==1){dn=total_question;}for(var el=ep;el<dn-1;el+=dw){var en=questionHolder[el+1];if(em[el].pageNext){continue;}var ek=createFreQdataNode("page");addNewQ(ek,false,false,em[el]);}}else{show_status_tip("最后一题不需要添加分页",4000);}};function dt(j){var dw=j.dataNode;if(dw._type=="page"){var i=parseInt(dw._topic);if(i>=x&&i<=Z){dw._mintime=cur.dataNode._mintime;dw._maxtime=cur.dataNode._maxtime;if(j.setMinMaxTime){j.setMinMaxTime();}}}}}if(dW||u){var a8="<a href='javascript:cur.show_divAddFromCheck();' class='link-U666' title='引用其它题的选中项'>引用其它题选中项</a>&nbsp;";var T=document.createElement("div");T.style.margin="10px 0px";var bq=$ce("select","",T);bq.style.width="220px";T.style.display="none";var d8=document.createElement("div");d8.style.display="none";d8.style.margin="10px 0";this.show_divAddFromCheck=function(){if(!T.inited){bq.onchange=function(){if(!vipUser){alert("只有企业版用户才能使用引用逻辑，请升级！");this.value="0";return;}cur.addFromCheck(this);};T.inited=true;$ce("label","&nbsp;<a target='_blank' href='/help/help.aspx?helpid=217&h=1' style='color:green;text-decoration:underline;'><b>帮助</b></a>",T);}T.style.display=T.style.display==""?"none":"";if(isMergeAnswer&&!this.isMergeNewAdded){T.style.display="none";}if(ar){if(bM){bM.style.display=T.style.display==""?"none":"";}if(di&&!di.checked){bM.style.display="none";}if(bq.value>0&&bM){bM.style.display="none";}}this.updateSelCheck();this.hasDisplaySelCheck=T.style.display=="";};this.updateSelCheck=function(){for(var el=0;el<bq.options.length;el++){bq.options[el]=null;}bq.options[0]=new Option("请选择来源题目(多选或排序题)",0);var ep=1;for(var el=0;el<questionHolder.length;el++){var eo=questionHolder[el].dataNode;var er=this.dataNode._topic;if(eo._type=="check"&&eo._topic-er<0&&!questionHolder[el]._referDivQ){var dw="[多选题]";if(eo._tag){dw="[排序题]";}var ek=eo._title;ek=ek.replace(/<(?!img|embed).*?>/ig,"");ek=ek.replace(/&nbsp;/ig," ").substring(0,16);var en=ek+"  "+dw;if(!WjxActivity._use_self_topic){en=eo._topic+"."+en;}var em=new Option(en,eo._topic);em.referDivQ=questionHolder[el];bq.options[ep++]=em;}}if(this._referDivQ){var eq=bq.options;for(var el=0;el<eq.length;el++){var j=eq[el];if(j.referDivQ==this._referDivQ){bq.value=j.value;break;}}}};this.addFromCheck=function(em){var ek=bq.selectedIndex;if(aI||bo){if(ek>0&&b6.checked){b6.checked=false;b6.onclick();}b6.disabled=ek>0?true:false;cq.style.display=ek>0?"none":"";}else{eg.style.display=ek>0?"none":"";if(aE){aE.style.display=eg.style.display;}}d8.style.display=ek>0?"":"none";this.clearReferQ();if(bq.value>0){if(this._referedArray){var dw="";for(var el=0;el<this._referedArray.length;el++){if(el>0){dw+=",";}dw+=this._referedArray[el].dataNode._topic;}show_status_tip("第"+dw+"题的选项或行标题来源于此题的选中项，此题不能再引用其他题");bq.value="0";this.show_divAddFromCheck();return;}var j=bq.options[bq.selectedIndex].referDivQ;this._referDivQ=j;if(!j._referedArray){j._referedArray=new Array();}if(j._referedArray.indexOf(this)==-1){j._referedArray.push(this);}j._referedArray.sort(function(en,i){return en.dataNode._topic-i.dataNode._topic;});this.updateReferQ();}else{this.show_divAddFromCheck();}if(this.dataNode._daoZhi){if(cF){cF.checked=false;this.dataNode._daoZhi=false;cA.updateSpanMatrix();show_status_tip("使用引用逻辑后，不能再使用竖向选择",5000);}}if(this.updateItem){this.updateItem();}else{if(this.createSum){this.createSum();}}};this.removeRefer=function(){bq.value="0";this.addFromCheck();};this.clearReferQ=function(){if(this._referDivQ){this._referDivQ._referedArray.remove(this);if(!this._referDivQ._referedArray.length){this._referDivQ._referedArray=null;}this._referDivQ=null;}};this.clearReferedQ=function(){if(this._referedArray){for(var j=0;j<this._referedArray.Length;j++){var dw=this._referedArray[j];dw._referDivQ=null;if(dw.updateItem){dw.updateItem();}else{if(dw.createSum){dw.createSum();}}}}};this.updateReferQ=function(){if(this._referDivQ){var i=this._referDivQ;var dw="选项";if(this.dataNode._type=="matrix"||this.dataNode._type=="sum"){dw="行标题";}var j="，<a href='javascript:cur.removeRefer();' class='link-U00a6e6'>取消引用</a>";if(isMergeAnswer&&!this.isMergeNewAdded){j="";}d8.innerHTML=dw+"来源于第"+i.dataNode._topic+"题的选中项"+j;}};}if(ef){$ce("div","",aB).style.clear="both";var dc=document.createElement("div");dc.style.marginLeft="15px";if(!dW){var dT=document.createElement("div");dT.style.margin="10px 0";dc.appendChild(dT);}aB.appendChild(dc);}if(ci){$ce("span","最小值：",dT);var aG=control_text("3");aG.title="用户可以选择的最小值";aG.maxLength=4;dT.appendChild(aG);$ce("span","&nbsp;&nbsp;&nbsp;&nbsp;最小值显示文本：",dT);var cd=control_text("10");dT.appendChild(cd);var bK=document.createElement("br");dT.appendChild(bK);$ce("span","最大值：",dT);var d=control_text("3");d.title="用户可以选择的最大值";d.maxLength=4;dT.appendChild(d);$ce("span","&nbsp;&nbsp;&nbsp;&nbsp;最大值显示文本：",dT);var aq=control_text("10");dT.appendChild(aq);aG.onchange=aG.onblur=function(){var i=100;if(!isInt(this.value)||this.value-d.value>0){show_status_tip("最小值不合法",4000);i=(0-d.value<0)?0:toInt(d.value)-1;}else{i=toInt(this.value);}cA.dataNode._minvalue=i;this.value=i;cA.get_span_min_value().innerHTML="("+i+")";};d.onchange=d.onblur=function(){if(!isInt(this.value)||this.value-aG.value<0){show_status_tip("最大值不合法",4000);val=(100-aG.value>0)?100:toInt(aG.value)+1;}else{val=toInt(this.value);}cA.dataNode._maxvalue=val;this.value=val;cA.get_span_max_value().innerHTML="("+val+")";};cd.onchange=cd.onblur=function(){this.value=replace_specialChar(this.value);cA.get_span_min_value_text().innerHTML=cA.dataNode._minvaluetext=this.value;};aq.onchange=aq.onblur=function(){this.value=replace_specialChar(this.value);cA.get_span_max_value_text().innerHTML=cA.dataNode._maxvaluetext=this.value;};}if(d5){dT.innerHTML="<span style='font-size:10px'>●&nbsp;</span>";$ce("span","上传文件允许的最大文件大小(KB)：",dT);var J=control_text("8");var dC=fileMaxSize/1024;J.maxLength=5;dT.appendChild(J);$ce("span","&nbsp;不能超过"+fileMaxSize+"KB("+dC+"M)",dT);J.onblur=J.onchange=function(){var i=J.value;if(i){if(isPositive(i)&&i-fileMaxSize<=0){cA.dataNode._maxsize=i;}else{cA.dataNode._maxsize=fileMaxSize;show_status_tip("最大文件大小必须为正数，并且不能超过"+fileMaxSize+"KB（即"+dC+"M）",3000);this.value="";}}else{cA.dataNode._maxsize=fileMaxSize;}cA.updateFileUpload();};$ce("br","",dT);$ce("span","<span style='font-size:10px'>●&nbsp;</span>上传文件允许的扩展名：",dT);var ak="<div><b>&nbsp;&nbsp;图片文件：</b><input type='checkbox' value=''/>全选&nbsp;&nbsp;<input type='checkbox' value='.gif'/>.gif&nbsp;<input type='checkbox' value='.png'/>.png&nbsp;<input type='checkbox' value='.jpg'/>.jpg&nbsp;<input type='checkbox' value='.jpeg'/>.jpeg&nbsp;<input type='checkbox' value='.bmp'/>.bmp&nbsp;</div>";ak+="<div><b>&nbsp;&nbsp;文档文件：</b><input type='checkbox' value=''/>全选&nbsp;&nbsp;<input type='checkbox' value='.doc'/>.doc&nbsp;<input type='checkbox' value='.docx'/>.docx&nbsp;<input type='checkbox' value='.pdf'/>.pdf&nbsp;<input type='checkbox' value='.xls'/>.xls&nbsp;<input type='checkbox' value='.xlsx'/>.xlsx&nbsp;<input type='checkbox' value='.ppt'/>.ppt&nbsp;<input type='checkbox' value='.pptx'/>.pptx&nbsp;<input type='checkbox' value='.txt'/>.txt&nbsp;</div>";ak+="<div><b>&nbsp;&nbsp;压缩文件：</b><input type='checkbox' value=''/>全选&nbsp;&nbsp;<input type='checkbox' value='.rar'/>.rar&nbsp;<input type='checkbox' value='.zip'/>.zip&nbsp;<input type='checkbox' value='.gzip'/>.gzip</div><div style='margin-top:10px;'>&nbsp;&nbsp;提示：用户上传的文件在您不删除的情况下默认会保存5年时间。</div>";var dU=$ce("div",ak,dT);cA.updateExt=function(ek){var i=$$("input",dU);var dw="";for(var j=0;j<i.length;j++){if(i[j].checked&&i[j].value){if(dw){dw+="|";}dw+=i[j].value;}}this.dataNode._ext=dw;this.updateFileUpload();};}if(cH&&cA.dataNode._verify!="多级下拉"){if(bR){var bV=document.createElement("div");dc.appendChild(bV);this.addCeShiSetting(bV);}var cR=this.get_span_maxword();var bZ=this.get_textarea();var bG=$ce("span","高度：",dT);var dL="<select onchange='cur.setTHeight(this);'><option value='1'>1行</option><option value='2'>2行</option><option value='3'>3行</option><option value='4'>4行</option><option value='5'>5行</option><option value='10'>10行</option><option value='自定义'>自定义</option></select>&nbsp;";bG.innerHTML+=dL;var df=$ce("span","",dT);var aN=control_text("3");aN.maxLength=3;aN.onchange=aN.onblur=function(){var i=this.value;if(!isEmpty(i)&&!isInt(i)){show_status_tip("您输入的高度不合法！");this.value="";cA.dataNode._height="1";}else{cA.dataNode._height=i?parseInt(i):"";}cA.showTextAreaHeight();};this.setTHeight=function(i){if(i.value!="自定义"){aN.value=i.value;df.style.display="none";aN.onchange();}else{df.style.display="";}};this.initHeight=function(){if(this.dataNode._height){var i=$$("select",bG)[0];i.value=this.dataNode._height;if(i.selectedIndex==-1){i.value="自定义";this.setTHeight(selWidth);}}};df.style.display="none";df.appendChild(aN);df.appendChild(document.createTextNode("行"));var cz=$ce("span","&nbsp;&nbsp;宽度：",dT);var cK="<select onchange='cur.setTWidth(this);'><option value=''>默认</option><option value='50'>50</option><option value='100'>100</option><option value='200'>200</option><option value='300'>300</option><option value='400'>400</option><option value='500'>500</option><option value='600'>600</option><option value='自定义'>自定义</option></select>&nbsp;";cz.innerHTML+=cK;var aU=control_text("5");aU.maxLength=3;aU.onchange=aU.onblur=function(){var i=this.value;if(!isEmpty(i)&&!isInt(i)){show_status_tip("您输入的宽度不合法！");this.value="";cA.dataNode._width="";}else{cA.dataNode._width=i?parseInt(i):"";if(i=="1"&&cA.dataNode._requir){l.click();}}cA.showTextAreaWidth();};this.setTWidth=function(i){if(i.value!="自定义"){aU.value=i.value;aU.style.display="none";aU.onchange();}else{aU.style.display="";}};this.initWidth=function(){if(this.dataNode._width){var i=$$("select",cz)[0];i.value=this.dataNode._width;if(i.selectedIndex==-1||this.dataNode._width=="1"){i.value="自定义";this.setTWidth(i);}}};dT.appendChild(cz);aU.style.display="none";dT.appendChild(aU);var N=$ce("span","&nbsp;&nbsp;",dT);var cn=control_check();N.appendChild(cn);N.appendChild(document.createTextNode("下划线样式"));cn.onclick=function(){cA.dataNode._underline=this.checked;cA.showTextAreaUnder();};var aS=$ce("span","&nbsp;&nbsp;",dT);var A=control_check();aS.appendChild(A);var cJ="默认值";var cr=$ce("span",cJ,aS);var bQ=control_textarea("1","18");bQ.style.overflow="auto";bQ.style.height="15px";bQ.style.display="none";A.onclick=function(){bQ.style.display=bQ.style.display=="none"?"":"none";if(!this.checked){cA.dataNode._olddefault=bQ.value;bQ.value="";}else{bQ.value=cA.dataNode._olddefault||"";}bQ.onchange();};aS.appendChild(bQ);bQ.onchange=bQ.onblur=function(){if(cA.checkDefault){cA.checkDefault();}};this.changeDefaultAttr=function(i){if(this.dataNode._verify=="省市区"||this.dataNode._verify=="高校"){cr.innerHTML="指定省份";bQ.onmouseover=function(){openProvinceWindow(cA,this);};bQ.onmouseout=function(){sb_setmenunav(toolTipLayer,false);};}else{cr.innerHTML=cJ;bQ.onmouseover=bQ.onmouseout=null;}if(i){bQ.value="";bQ.onchange();}};var c3=document.createElement("div");var ca=control_check();var cm=document.createElement("span");var aD=getVerifyHtml(0);cm.innerHTML=aD;c3.appendChild(cm);this.setVerify=function(j){var i=false;if(this.dataNode._verify=="省市区"||j.value=="省市区"||this.dataNode._verify=="高校"||j.value=="高校"){i=true;}this.dataNode._verify=j.value;if(this.dataNode._verify=="数字"||this.dataNode._verify=="小数"){aC.innerHTML=aC.innerHTML.replace("字数","值");aj.innerHTML=aj.innerHTML.replace("字数","值");ag="值";}else{aC.innerHTML=aC.innerHTML.replace("值","字数");aj.innerHTML=aj.innerHTML.replace("值","字数");ag="字数";}this.changeDefaultAttr(i);this.showTextAreaDate();this.showByVerify();this.showSmsVerify();};this.showByVerify=function(){var j=this.dataNode._verify;if(by){by.style.display=j=="手机"?"":"none";}var i=j=="数字"||j=="小数"||j=="汉字"||j=="英文"||j==""||j=="0";aZ.style.display=i?"":"none";};this.initVerify=function(){var j=this.dataNode._verify||"0";var i=$$("select",cm)[0];i.value=j;this.showByVerify();};var aZ=$ce("span","&nbsp;",c3);var ag="字数";if(m._verify=="数字"||m._verify=="小数"){ag="值";}var aC=$ce("span","最小"+ag+"：",aZ);var au=control_text("4");au.title="不填表示无限制";aZ.appendChild(au);au.onchange=au.onblur=function(){var j=this.value;var i=eb.value;if(!isEmpty(j)&&(!isInt(j)||(!isEmpty(i)&&this.value-i>0))){show_status_tip("最小"+ag+"不合法",4000);this.value="";}else{if(!isEmpty(j)&&cA.dataNode._verify!="数字"&&cA.dataNode._verify!="小数"){if(j-3000>0){show_status_tip("最小字数不能超过3000",4000);this.value="";}}}cA.dataNode._minword=this.value;cA.showMinMaxWord(i,this.value);cA.checkDefault();};var aj=$ce("span","最大"+ag+"：",aZ);aj.style.marginLeft="10px";var eb=control_text("4");eb.title="不填表示无限制";eb.onchange=eb.onblur=function(){var j=this.value;var i=au.value;if(!isEmpty(j)&&(!isInt(j)||(!isEmpty(i)&&this.value-i<0))){show_status_tip("最大字数不合法",4000);this.value="";}else{if(!isEmpty(j)&&cA.dataNode._verify!="数字"&&cA.dataNode._verify!="小数"){if(j-3000>0){show_status_tip("最大字数不能超过3000",4000);this.value="";}}}cA.dataNode._maxword=this.value;cA.showMinMaxWord(this.value,i);cA.checkDefault();};aZ.appendChild(eb);var cu=control_check();var c4=$ce("span","&nbsp;&nbsp;",c3);c4.appendChild(cu);$ce("span","不允许重复&nbsp;",c4);cu.onclick=function(){if(!vipUser){this.checked=false;alert("此功能只对企业版用户开放，请升级！");return;}cA.dataNode._needOnly=this.checked;if(this.checked&&!cA.dataNode._requir){show_status_tip("由于设置了唯一性，推荐将该题设为必答题",4000);l.click();}};cu.title="要求每个人填写的答案是唯一的";var bY=control_check();var by=$ce("span","&nbsp;&nbsp;",c3);by.appendChild(bY);$ce("span","使用短信验证&nbsp;&nbsp短信余额：<span style='color:red;'>"+smsBalance+"</span>，<a href='/corphome/account/prepaysms.aspx?amount=500' target='_blank' class='titlelnk'>购买</a>",by);bY.onclick=function(){cA.dataNode._needsms=this.checked;if(this.checked&&!cA.dataNode._requir){show_status_tip("由于设置了短信验证，推荐将该题设为必答题",4000);l.click();}cA.showSmsVerify();};dc.appendChild(c3);this.changeDefaultAttr();if(bR){c3.style.display="none";}}else{if(cH&&cA.dataNode._verify=="多级下拉"){var cI="/wjx/design/setmenulist.aspx?ct="+cA.dataNode._topic;var dv=$ce("span","<a class='BS_btn' href='javascript:' onclick='PDF_launch(\""+cI+"\",500,500);'>点击设置多级下拉选项</a>",dT);}}if(dY){var dD=document.createElement("div");var c8=document.createElement("span");dD.appendChild(c8);this.gapSelClick=function(el){var ek=getGapFillCount(m._title);if(ek==el.options.length-1){return;}el.options.length=0;el.options.add(new Option("请选择空","-1"));for(var dw=0;dw<ek;dw++){var j=new Option("填空"+(dw+1),dw);el.options.add(j);}};this.refreshSelRow=function(){var el=this.dataNode;var ek=getGapFillCount(el._title);var dw="";var i="填空属性";if(bR){i="答案设置";}c8.innerHTML="<b>"+i+"</b>：<select style='width:80px;' onclick='cur.gapSelClick(this);'></select>";var j=$$("select",c8)[0];this.gapSelClick(j);j.onchange=function(){var ep=this.value;var eo=parseInt(ep);cO.style.display=eo<0?"none":"";var en=$$("select",cO)[0];if(!cA.dataNode._rowVerify||!cA.dataNode._rowVerify[eo]){en.value="0";au.value="";eb.value="";return;}en.value=cA.dataNode._rowVerify[eo]._verify||"0";aM.value=cA.dataNode._rowVerify[eo]._choice||"";au.value=cA.dataNode._rowVerify[eo]._minword||"";eb.value=cA.dataNode._rowVerify[eo]._maxword||"";if(cA.dataNode._isCeShi){var em=$$("select",bi)[0];em.value=cA.dataNode._rowVerify[eo]._ceshiValue||"1";aY.value=cA.dataNode._rowVerify[eo]._answer||"";cE.value=cA.dataNode._rowVerify[eo]._ceshiDesc||"";ac.checked=cA.dataNode._rowVerify[eo]._include||false;}cA.setVerify(en);};};this.refreshSelRow();dD.style.margin="10px 0 0 15px";aB.appendChild(dD);var cO=document.createElement("span");var aT=$ce("span","&nbsp;",cO);cO.style.display="none";var aD=getVerifyHtml();aT.innerHTML="&nbsp;"+aD;dD.appendChild(cO);this.setVerify=function(dw){if(!this.dataNode._rowVerify){this.dataNode._rowVerify=new Array();}var i=$$("select",c8)[0];var el=i.value;var ek=parseInt(el);if(!cA.dataNode._rowVerify[ek]){cA.dataNode._rowVerify[ek]=new Object();}var j=this.dataNode._rowVerify[ek]._verify;this.dataNode._rowVerify[ek]._verify=dw.value;if(dw.value=="数字"||dw.value=="小数"){aC.innerHTML=aC.innerHTML.replace("字数","值");aj.innerHTML=aj.innerHTML.replace("字数","值");ag="值";}else{aC.innerHTML=aC.innerHTML.replace("值","字数");aj.innerHTML=aj.innerHTML.replace("值","字数");ag="字数";}if(dw.value=="数字"||dw.value=="小数"||dw.value=="汉字"||dw.value=="英文"||dw.value=="0"){aZ.style.display="";}else{aZ.style.display="none";}dP.style.display=dw.value=="指定选项"?"":"none";this.checkTitle();};this.initVerify=function(){var j=this.dataNode._verify||"0";var i=$$("select",cO)[0];i.value=j;};var aZ=$ce("span","&nbsp;",cO);var ag="字数";if(m._verify=="数字"||m._verify=="小数"){ag="值";}var aC=$ce("span","最小"+ag+"：",aZ);var au=control_text("4");au.title="不填表示无限制";aZ.appendChild(au);au.onchange=au.onblur=function(){var el=this.value;var j=$$("select",c8)[0];var dw=j.value;var ek=parseInt(dw);if(!cA.dataNode._rowVerify[ek]){cA.dataNode._rowVerify[ek]=new Object();}var i=checkVerifyMinMax(au,eb,cA.dataNode._rowVerify[ek]._verify);if(i){show_status_tip(i,4000);this.value="";}cA.dataNode._rowVerify[ek]._minword=this.value;};var aj=$ce("span","最大"+ag+"：",aZ);aj.style.marginLeft="10px";var eb=control_text("4");eb.title="不填表示无限制";eb.onchange=eb.onblur=function(){var el=this.value;var j=$$("select",c8)[0];var dw=j.value;var ek=parseInt(dw);if(!cA.dataNode._rowVerify[ek]){cA.dataNode._rowVerify[ek]=new Object();}var i=checkVerifyMinMax(au,eb,cA.dataNode._rowVerify[ek]._verify);if(i){show_status_tip(i,4000);this.value="";}cA.dataNode._rowVerify[ek]._maxword=this.value;};aZ.appendChild(eb);var dP=$ce("span","&nbsp;<b>设置选项：</b><a title='提示：选项与选项之间使用逗号分割' href='javascript:void(0);' onclick='alert(this.title);' style='color:green;'><b>(?)</b></a>",cO);var aM=control_text("32");aM.value="";dP.appendChild(aM);dP.style.display="none";aM.onchange=aM.onblur=function(){var ek=this.value;ek=ek.replace(/'"¦/g,"");this.value=ek;if(!trim(ek)){show_status_tip("选项不能为空！",4000);return;}var i=$$("select",c8)[0];var j=i.value;var dw=parseInt(j);if(!cA.dataNode._rowVerify[dw]){cA.dataNode._rowVerify[dw]=new Object();}cA.dataNode._rowVerify[dw]._choice=ek;};if(bR){aZ.style.display="none";aT.style.display="none";var bi=$ce("span","分值：",cO);bi.style.marginLeft="15px";var dK="<select onchange='cur.setTValue(this);'>";for(var dG=1;dG<=10;dG++){dK+="<option value='"+dG+"'>"+dG+"</option>";}dK+="</select>&nbsp;";bi.innerHTML+=dK;this.setTValue=function(dw){var i=$$("select",c8)[0];var j=i.value;var ek=parseInt(j);if(!cA.dataNode._rowVerify[ek]){cA.dataNode._rowVerify[ek]=new Object();}cA.dataNode._rowVerify[ek]._ceshiValue=dw.value;cA.checkTitle();};cO.appendChild(bi);var dq=$ce("span","&nbsp;答案：",cO);var aY=control_text("8");dq.appendChild(aY);$ce("span","<a title='如果有多个答案，请以“|”分隔' href='javascript:void(0);' onclick='alert(this.title);' style='color:green;'><b>(?)</b></a>&nbsp;",dq);aY.onchange=aY.onblur=function(){this.value=this.value.replace(/｜/,"|");var ek=this.value;var i=$$("select",c8)[0];var j=i.value;var dw=parseInt(j);if(!cA.dataNode._rowVerify[dw]){cA.dataNode._rowVerify[dw]=new Object();}cA.dataNode._rowVerify[dw]._answer=this.value;cA.checkTitle();};var ac=control_check();dq.appendChild(ac);$ce("span","<b>包含答案即可得分</b><a title='用户提交的答案不需要跟设置的答案完全一样，只要包含设置的答案就可得分。' href='javascript:void(0);' onclick='alert(this.title);' style='color:green;'><b>(?)</b></a>",dq);ac.onclick=function(){if(!vipUser){alert("此功能只对企业版用户开放，请升级！");this.checked=false;return;}var i=$$("select",c8)[0];var j=i.value;var dw=parseInt(j);if(!cA.dataNode._rowVerify[dw]){cA.dataNode._rowVerify[dw]=new Object();}cA.dataNode._rowVerify[dw]._include=this.checked;};var cL=$ce("span","&nbsp;&nbsp;答案解析<a title='您可以填写针对此题答案的一些解析说明，在用户参与完测试后会看到此解析' onclick='alert(this.title);' href='javascript:void(0);' style='color:green;'><b>(?)</b></a>：",cO);var cE=control_text("10");cL.appendChild(cE);cE.style.display="none";cE.onchange=cE.onblur=function(){var ek=this.value;var i=$$("select",c8)[0];var j=i.value;var dw=parseInt(j);if(!cA.dataNode._rowVerify[dw]){cA.dataNode._rowVerify[dw]=new Object();}cA.dataNode._rowVerify[dw]._ceshiDesc=this.value;};$ce("span","&nbsp;",cO);var dH=$ce("a","设置答案解析",cO);dH.href="javascript:void(0)";dH.className="link-U666";dH.onclick=function(){if(!vipUser){alert("此功能只对企业版用户开放，请升级！");return;}openTitleEditor(cE,function(i){if(i=="-1nc"||i==undefined){return;}cE.value=trim(i);cE.onchange();});};}}if(dW){var cq=document.createElement("div");cq.style.clear="both";}var dX=false;for(var dG=0;dG<questionHolder.length;dG++){var I=questionHolder[dG].dataNode;if(I._type=="cut"||I._type=="page"){continue;}var d4=I._topic;if(d4-this.dataNode._topic<0&&I._type=="check"){dX=true;break;}else{if(d4-this.dataNode._topic>=0){break;}}}if(ar||u){var bx=document.createElement("div");bx.style.padding="10px 0 0 10px";if(ar){cq.appendChild(bx);bx.style.width="315px";if(b0){bx.style.width="385px";}}else{dc.appendChild(bx);}var dh=document.createElement("div");dh.style.marginRight="5px";bx.appendChild(dh);dh.className="matrixtitle";if(b0){dh.style.width="186px";}if(u){bx.style.background="#D5E2F2";bx.style.width="400px";var co=$ce("div","可分配的总比重值：",dh);var cQ=control_text("3");cQ.style.height="16px";cQ.maxLength=3;cQ.style.overflow="auto";cQ.value=this.dataNode._total||"100";co.appendChild(cQ);cQ.onchange=cQ.onblur=function(){if(isInt(this.value)&&parseInt(this.value)>0){cA.dataNode._total=parseInt(this.value);}else{cA.dataNode._total=100;show_status_tip("可分配总比重值要大于0",4000);}this.value=cA.dataNode._total;};}var bj=ar?"左行标题":"比重评估项目";if(b0){bj="行标题";}var b9=b0?"16":"30";var eh=u?"4":"6";if(isMergeAnswer&&!this.isMergeNewAdded){a8="";}if(!dX){a8="";}var ce=$ce("div","<span style='float:left;'><b>"+bj+"</b>：</span>",dh);if(ar&&!b0){var bs=$ce("span","",ce);bs.className="spanRight";bs.style.paddingRight="20px";var di=control_check();bs.appendChild(di);var bB=$ce("span","右行标题",bs);di.checked=m._rowtitle2?true:false;}$ce("div","",ce).className="divclear";var eg=control_textarea(eh,b9);eg.style.overflow="auto";eg.tabIndex=1;eg.value=this.dataNode._rowtitle;eg.style.margin="0px";if(!isMergeAnswer||this.isMergeNewAdded){eg.title="相当于每个小题的标题";}else{eg.oldLen=eg.value.split("\n").length;eg.oldValue=eg.value;eg.title="特别提示：有答卷的情况下只能修改文字，不能增加或删除行标题，也不能移动行标题顺序";eg.onclick=function(){if(!eg.alert){alert(eg.title);eg.alert=true;}};eg.onkeypress=function(i){var i=i||window.event;if(i.keyCode==13){alert("有答卷的情况下不能添加新行，只能修改文字内容！");if(i.preventDefault){i.preventDefault();}if(i.returnValue!==undefined){i.returnValue=false;}event.keyCode=0;return false;}};}dh.appendChild(eg);this.checkRowTitle=function(){this.popHint("");var dw="";if(trim(eg.value)==""){this.popHint(bj+"不能为空！");eg.focus();this.isRowTitleValid=false;return false;}else{var en=eg.value.split("\n");var em=0;for(var el=0;el<en.length;el++){if(trim(en[el])!=""){if(em>0){dw+="\n";}dw+=en[el];em++;}for(var ek=el+1;ek<en.length;ek++){if(trim(en[el])!=""&&trim(en[el])==trim(en[ek])){this.popHint(bj+"的第"+(el+1)+"行与第"+(ek+1)+"行重复，请修改！");this.isRowTitleValid=false;return false;}}}}var eo=dw.split("\n").length;if(eg.oldLen&&eo!=eg.oldLen){if(!confirm("有答卷的情况下不能增加或删除行标题，只能修改文字内容！\r\n是否还原为初始状态的值？")){this.isRowTitleValid=false;return false;}dw=eg.oldValue;}this.isRowTitleValid=true;eg.value=dw;this.dataNode._rowtitle=dw;return true;};eg.onfocus=function(){if(this.value=="外观\n功能"){this.value="";}};eg.onblur=function(){if(!this.value){this.value="外观\n功能";}cA.checkRowTitle();if(u){cA.createSum();}else{if(ar){cA.updateItem();if(cA.refreshSelRow){cA.refreshSelRow();}}}};if(ar&&!b0){var bM=document.createElement("div");bM.style.display=di.checked?"":"none";setFloat(bM);bx.appendChild(bM);var cB=control_check();var R=$ce("div","",bM);R.appendChild(cB);$ce("span","右行标题(可选)",R);cB.checked=di.checked;di.onclick=cB.onclick=function(){bM.style.display=this.checked?"":"none";eg.style.width=this.checked?"150px":"290px";dh.style.width=this.checked?"156px":"";aJ.style.display=this.checked?"":"none";di.style.display=this.checked?"none":"";bB.style.display=this.checked?"none":"";di.checked=cB.checked=this.checked;if(!this.checked){dx.prevValue=dx.value;dx.value="";}else{if(!dx.value){dx.value=dx.prevValue||"";}}dx.onblur();};var dx=control_textarea("6","14");bM.appendChild(dx);dx.style.overflow="auto";dx.value=this.dataNode._rowtitle2||"";dx.title="适用于“语义差异法”等场景";this.checkRowTitle2=function(){if(ar){dx.value=replace_specialChar(dx.value);this.dataNode._rowtitle2=dx.value;}return true;};dx.onblur=function(){cA.checkRowTitle2();cA.updateItem();};}if(b0){var b=document.createElement("div");setFloat(b);bx.appendChild(b);$ce("div","<b>列标题：</b>&nbsp;",b);var aR=control_textarea("6","16");aR.style.overflow="auto";aR.value=this.dataNode._columntitle;aR.style.margin="0px";if(!isMergeAnswer||this.isMergeNewAdded){aR.title="列标题";}else{aR.disabled=true;aR.title="合并答卷模式下不能更改！";}b.appendChild(aR);aR.onblur=function(){cA.checkColumnTitle();cA.updateItem();};this.checkColumnTitle=function(){this.popHint("");if(trim(aR.value)==""){this.popHint("列标题不能为空！");aR.focus();this.isColumnTitleValid=false;return false;}else{var el=aR.value.split("\n");for(var ek=0;ek<el.length;ek++){for(var dw=ek+1;dw<el.length;dw++){if(trim(el[ek])!=""&&trim(el[ek])==trim(el[dw])){this.popHint("列标题的第"+(ek+1)+"行与第"+(dw+1)+"行重复，请修改！");this.isColumnTitleValid=false;return false;}}}}this.isColumnTitleValid=true;aR.value=replace_specialChar(aR.value);this.dataNode._columntitle=aR.value;return true;};}$ce("div","",bx).className="divclear";this.addLabel=function(){var i="\n【标签】标签名";var j=eg.value.length;eg.focus();if(typeof document.selection!="undefined"){document.selection.createRange().text=i;}else{eg.value=eg.value.substr(0,eg.selectionStart)+i+eg.value.substring(eg.selectionStart,j);}eg.onblur();};var H=$ce("div","<a href='javascript:void(0);' onclick='cur.addLabel();' class='link-U666'>插入标签</a>&nbsp;&nbsp;"+a8,bx);H.style.marginBottom="8px";if(ar){var dl=control_check();dl.onclick=function(){if(!vipUser){alert("只有企业版用户才能设置行标题随机，请升级！");this.checked=false;return;}cA.dataNode._randomRow=this.checked;};dl.checked=cA.dataNode._randomRow;var X=document.createElement("span");X.innerHTML="行标题随机&nbsp;&nbsp;";X.title="标题随机显示";H.appendChild(dl);H.appendChild(X);}if(b0){var dg="<a href='javascript:void(0);' class='link-444' onclick='cur.changeRowColumnTitle();'>交换行列标题</a>";$ce("span",dg,H);this.changeRowColumnTitle=function(){var i=this.dataNode._rowtitle;this.dataNode._rowtitle=this.dataNode._columntitle;this.dataNode._columntitle=i;eg.value=this.dataNode._rowtitle;aR.value=cur.dataNode._columntitle;this.updateItem();};}bx.appendChild(T);bx.appendChild(d8);if(ar){var dZ=document.createElement("div");dZ.style.margin="8px 0 5px";$ce("span","最小值：",dZ);var ct=control_text("3");ct.title="用户可以选择的最小值";ct.maxLength=3;ct.value=this.dataNode._minvalue;dZ.appendChild(ct);ct.onchange=ct.onblur=function(){var i=this.value;if(!isEmpty(this.value)||cA.dataNode._tag=="202"){if(!isInt(this.value)||this.value-ao.value>0){show_status_tip("最小值不合法",4000);i=(0-ao.value<0)?0:toInt(ao.value)-1;if(parseInt(i)!=i){i=0;}}else{i=toInt(this.value);}}this.value=cA.dataNode._minvalue=i;cA.updateItem();if(cA.updateSpanCheck){cA.updateSpanCheck();}};$ce("span","最大值：",dZ).style.marginLeft="60px";var ao=control_text("3");ao.title="用户可以选择的最大值";ao.maxLength=3;if(this.dataNode._tag=="301"){ct.maxLength=ao.maxLength=12;ct.style.width=ao.style.width="80px";}ao.value=this.dataNode._maxvalue;dZ.appendChild(ao);dZ.style.display=(this.dataNode._tag=="202"||this.dataNode._tag=="301")?"":"none";ao.onchange=ao.onblur=function(){var i=this.value;if(!isEmpty(this.value)||cA.dataNode._tag=="202"){if(!isInt(this.value)||this.value-ct.value<0){show_status_tip("最大值不合法",4000);i=(10-ct.value>0)?10:toInt(ct.value)+1;if(parseInt(i)!=i){i=10;}}else{i=toInt(this.value);}}this.value=cA.dataNode._maxvalue=i;cA.updateItem();if(cA.updateSpanCheck){cA.updateSpanCheck();}};bx.appendChild(dZ);}}if(dW){$ce("div","",dc).style.paddingTop="10px";var d0=document.createElement("div");d0.style.margin="5px 0";if(M||cS){d0.style.display="none";}var de=$ce("div","",d0);if(az||aX){var bT=document.createElement("span");bT.className="spanRight";de.appendChild(bT);var bu="<ul class='likertImageTypeList' style='display:inline;margin:0;' ><li>&nbsp;&nbsp;<b>样式：</b></li>";if(ar){bu+="<li class='design-icon design-offr' onclick='cur.set_likertMode(101);'></li>";}else{bu+="<li style='font-size:16px;'><a style='height:24px;line-height:24px;display:inline-block;' href='javascript:cur.set_likertMode(1);'><b>123</b></a></li> <li class='design-icon design-offr' onclick='cur.set_likertMode(101);'></li>";}var bC="";bu+="<li style='background:url(/images/wjx/JoinQuestionnaire/Rate/jianbian.png) no-repeat;width:24px;height:24px;' onclick='cur.set_likertMode(6);' style='"+bC+"'></li>";bu+="<li class='design-icon design-on2' onclick='cur.set_likertMode(2);' style='"+bC+"'></li>";bu+="<li  class='design-icon design-on3' onclick='cur.set_likertMode(3);'  style='"+bC+"'></li>";bu+="<li  class='design-icon design-on4' onclick='cur.set_likertMode(4);' style='"+bC+"'></li>";bu+="<li style='clear:both;'></li>";bu+="</ul>";bT.innerHTML=bu;this.set_likertMode=function(i){var j=this.dataNode._tag<102;this.dataNode._tag=i;this.createTableRadio(true);if(this.dataNode._type=="matrix"){d0.style.display=i>200?"none":"";b4.style.display=d0.style.display;if(j&&i>101){P.disabled=false;P.checked=false;P.onclick();this.dataNode._hasvalue=false;}else{if(!j&&i<102){P.checked=true;P.onclick();P.disabled=true;this.dataNode._hasvalue=true;}}P.disabled=i>101?false:true;if(!isMergeAnswer||this.isMergeNewAdded){cG.style.display=i>101?"none":"";}if(i==202){dZ.style.display="";this.dataNode._minvalue=this.dataNode._minvalue||0;this.dataNode._maxvalue=this.dataNode._maxvalue||10;this.dataNode._rowwidth=this.dataNode._rowwidth||100;rowwidth_text.value=rowwidth_text.value||100;}else{dZ.style.display="none";}}};if(isMergeAnswer&&!this.isMergeNewAdded&&this.dataNode._tag>101){bT.style.display="none";}}if(((aX)||ar)&&(!isMergeAnswer||this.isMergeNewAdded)){var cG=$ce("span","",de);cG.className="spanRight";var cD=document.createElement("span");var b8="<select onchange='cur.set_likert_num(this);'>";var p=m._select.length-1;for(var dG=2;dG<=10;dG++){var b7="";if(dG==p){b7=" selected='selected' ";}b8+="<option"+b7+" value='"+dG+"'>"+dG+"级量表</option>";}b8+="</select>";cD.innerHTML+=b8;this.set_likert_num=function(dw){var ek=dw.value;var j=cZ.length-1;for(var i=0;i<ek;i++){cZ[j+i].get_item_add().onclick();cZ[j+i+1].get_item_title().value=i+1;cZ[j+i+1].get_item_value().value=i+1;}for(var i=1;i<j+1;i++){cZ[1].get_item_del().onclick();}if(!az){cZ[1].get_item_title().value="非常不满意";cZ[cZ.length-1].get_item_title().value="非常满意";}cZ[1].get_item_title().onchange();this.popHint("");window.focus();};cG.appendChild(cD);if(ar&&this.dataNode._tag>101){cG.style.display="none";}}if(ar){cq.style.background="#D5E2F2";}if(cx=="radio"||cx=="check"){if(cW){cq.style.width="75%";}else{if(bR){cq.style.width="66%";}else{if(M){cq.style.width="62%";}else{if(cS){cq.style.width="70%";}else{if(ee){if(cx=="radio"){cq.style.width="100%";}else{cq.style.width="82%";}}}}}}}else{if(cx=="matrix"){if(cW=="201"||cW=="202"||cW=="301"||cW=="302"){cq.style.width="400px";}if(cW=="301"||cW=="302"){cq.style.width="500px";}}else{cq.style.width="75%";}}if(!ar){d0.appendChild(T);d0.appendChild(d8);}this.setNotNewAdd=function(){if(!cA.newAddQ){return;}c1.style.display="";cA.newAddQ=false;b4.style.display="";};this.addNewItem=function(){var i=cZ.length;cZ[i-1].get_item_add().onclick();};if(bF){var ax=$ce("div","<span style='color:#333; font-weight:bold;'>投票设置：</span>",d0);ax.style.marginTop="10px";var dB=$ce("span","&nbsp;&nbsp;",ax);var bz=control_check();dB.appendChild(bz);dB.appendChild(document.createTextNode("选项说明点击后弹出"));var g=control_check();dB.appendChild(g);dB.appendChild(document.createTextNode("显示投票数"));var dp=control_check();dB.appendChild(dp);dB.appendChild(document.createTextNode("显示百分比"));bz.checked=bz.defaultChecked=m._displayDesc;g.checked=g.defaultChecked=m._displayNum;dp.checked=dp.defaultChecked=m._displayPercent;bz.onclick=function(){var ek=false;var dw=cA.dataNode._select;for(var j=1;j<dw.length;j++){if(dw[j]._item_desc){ek=true;}}if(!ek&&this.checked){alert("提示：您的投票选项没有添加说明，不能应用此设置！");this.checked=false;return;}cA.dataNode._displayDesc=this.checked;cA.createTableRadio(true);};dp.onclick=function(){cA.dataNode._displayPercent=this.checked;cA.createTableRadio(true);};g.onclick=function(){cA.dataNode._displayNum=this.checked;cA.createTableRadio(true);};var O=$ce("span","选项宽度：",ax);O.style.marginLeft="15px";var dK="<select onchange='cur.setTWidth(this);'><option value='20'>20%</option><option value='30'>30%</option><option value='40'>40%</option><option value='50'>50%</option><option value='60'>60%</option><option value='70'>70%</option><option value='自定义'>自定义</option></select>&nbsp;";O.innerHTML+=dK;var r=$ce("span","",O);var b5=control_text("3");b5.maxLength=2;b5.onchange=b5.onblur=function(){var i=this.value;if(!isEmpty(i)&&!isInt(i)){show_status_tip("您输入的宽度不合法！");this.value="";cA.dataNode._touPiaoWidth=50;}else{cA.dataNode._touPiaoWidth=i?parseInt(i):"";}cA.createTableRadio(true);};this.setTWidth=function(i){if(i.value!="自定义"){b5.value=i.value;r.style.display="none";b5.onchange();}else{r.style.display="";}};this.initWidth=function(){if(this.dataNode._touPiaoWidth){b5.value=this.dataNode._touPiaoWidth;var ek=$$("select",O)[0];ek.value=this.dataNode._touPiaoWidth;var j=true;for(var dw=0;dw<ek.options.length;dw++){if(ek.options[dw].value==this.dataNode._touPiaoWidth){j=false;break;}}if(j){ek.value="自定义";this.setTWidth(ek);}}};r.appendChild(b5);r.appendChild(document.createTextNode("%"));r.style.display="none";ax.appendChild(O);this.initWidth();}else{if(bR){this.addCeShiSetting(d0);}}var b4=$ce("div","",cq);var aW=document.createElement("table");aW.className="tableoption";aW.style.backgroundColor="#D5E2F2";aW.cellSpacing="3";aW.cellPadding="3";aW.width="94%";var cs=aW.insertRow(-1);cZ[0]=cs;var bd=!m._tag&&!ee&&(m._type=="check"||m._type=="radio"||m._type=="radio_down");var D=cs.insertCell(-1);D.style.width="150px";if(ar&&cW&&cW<=101){D.style.width="100px";}if(ar&&cW=="303"){D.style.width="120px";}var dE=$ce("span","",D);if(cS){dE.innerHTML="商品名称";}else{var dR=$ce("a","选项文字<img src='http://image.sojump.com/images/WJX/ViewStat/arrownone.gif' alt=''>",dE);dR.title="交换选项文字";dR.style.fontWeight="bold";dR.style.color="#333333";dR.style.fontSize="14px";dR.style.textDecoration="none";dR.href="javascript:void(0);";dR.onclick=function(){if(isMergeAnswer&&!cur.isMergeNewAdded){show_status_tip("合并答卷模式不能交换选项文字",4000);return false;}var el=false;var j=false;if(aX||az||ee||cW==303){j=true;}if(j&&confirm("是否同时交换选项分数？")){el=true;}var ek=1;var i=cZ.length-1;while(ek<i){var dw=cZ[i].get_item_title().value;cZ[i].get_item_title().value=cZ[ek].get_item_title().value;cZ[ek].get_item_title().value=dw;if(el){dw=cZ[i].get_item_value().value;cZ[i].get_item_value().value=cZ[ek].get_item_value().value;cZ[ek].get_item_value().value=dw;if(cZ[i].get_item_novalue()){dw=cZ[i].get_item_novalue().checked;cZ[i].get_item_novalue().checked=cZ[ek].get_item_novalue().checked;cZ[ek].get_item_novalue().checked=dw;}}ek++;i--;}cur.updateItem();return false;};}if(ee||(bd&&m._type!="radio_down"&&!M)){var an=cs.insertCell(-1);var d3="图片";imgwidth="27px";if(cS){d3="商品图片";imgwidth="50px";}$ce("span",d3,an);an.style.width=imgwidth;}if(ee||(bd&&m._type!="radio_down"&&!cS)){var c6=cs.insertCell(-1);var bL="说明";var dj="27px";if(M){bL="情景说明";dj="50px";}$ce("span",bL,c6);c6.style.width=dj;}if((bd&&m._type!="radio_down")||(ar&&(cW=="102"||cW=="103"||cW=="101"))||ee){var dk=cs.insertCell(-1);var al=$ce("span","<b>可填空</b>",dk);dk.style.width="70px";if(bR||M||cS){dk.style.display="none";}}var aw=cs.insertCell(-1);if(!bR&&!b0&&!M){aw.style.width="90px";}if(cS){aw.style.width="50px";}var bw=$ce("span","",aw);var P=control_check();P.title="给选项设置分数，可用于Likert量表或者测试类型的问卷";bw.appendChild(P);var dd=$ce("span","",bw);dd.innerHTML="&nbsp;<b>分数</b><span class='bordCss bordBottomCss' style='border-color:#2E6AB1 transparent transparent;'></span>";dd.style.cursor="pointer";if(M){dd.innerHTML="数量";}else{if(cS){dd.innerHTML="商品价格";}}if(aX||az||ee||cW==303){P.style.display="none";bw.onmouseover=function(){openValWindow(cA,this);};bw.onmouseout=function(){sb_setmenunav(toolTipLayer,false);};}else{if(!M&&!cS){aw.style.display="none";}else{P.style.display="none";}}P.onclick=function(){if(cA.dataNode._isCeShi){return;}if(this.checked){for(var i=1;i<cZ.length;i++){cZ[i].get_item_value().parentNode.style.display="";}}else{for(var i=1;i<cZ.length;i++){cZ[i].get_item_value().parentNode.style.display="none";}}cA.dataNode._hasvalue=this.checked;};var bI=cs.insertCell(-1);if(cx=="radio"||cx=="radio_down"){if(!bR&&!M){bI.style.width="80px";}var a0=$ce("span","&nbsp;",bI);if(bR||M){a0.style.display="none";}var c0=control_check();var bh=$ce("span","跳题",a0);var aO=$ce("a","<b>(?)</b>",bh);aO.href="javascript:void(0);";aO.style.color="green";aO.onmouseover=function(){toolTipLayer.style.width="250px";toolTipLayer.innerHTML="按选项跳题，允许用户填写此题时根据选中的选项跳到后面指定的题号。<a target='_blank' class='link-U00a6e6' href='/help/help.aspx?helpid=218&h=1'>查看示例</a>";sb_setmenunav(toolTipLayer,true,this);};aO.onmouseout=function(){sb_setmenunav(toolTipLayer,false,this);};a0.appendChild(c0);a0.appendChild(bh);c0.onclick=function(){if(this.checked){cA.dataNode._anytimejumpto="";bE.value="";if(bU.checked){bU.click();}for(var i=1;i<cZ.length;i++){cZ[i].get_item_jump().parentNode.style.display="";}}else{for(var i=1;i<cZ.length;i++){cZ[i].get_item_jump().parentNode.style.display="none";}}if(cA.defaultCheckSet){cA.defaultCheckSet();}cA.dataNode._hasjump=this.checked;cA.set_jump_ins();cA.updateItem();};}else{if(cS){bI.innerHTML="总库存";bI.style.width="80px";}}if(cx=="check"&&!bR&&!dS&&!ee&&!cS){var bH=cs.insertCell(-1);var K=$ce("span","&nbsp;",bH);var bP=$ce("span","选项互斥",K);bP.title="与其它选项互斥";K.appendChild(bP);}if(cx=="matrix"){bI.style.display="none";}var cj=cs.insertCell(-1);if(bd&&!M&&!cS){var bm=$ce("span","&nbsp;",cj);var b1=$ce("span","",bm);b1.innerHTML="默认";if(bR){b1.innerHTML="正确答案";}this.defaultCheckSet=function(){if(this.dataNode._isCeShi){return;}var j=bU.checked||(c0?c0.checked:false);for(var i=1;i<cZ.length;i++){var dw=cZ[i].get_item_check();dw.parentNode.style.display=j?"none":"";if(j){dw.checked=false;}}};}else{cj.style.display="none";}if(bd&&m._type!="radio_down"){var b3=cs.insertCell(-1);$ce("span","分组<a href='/help/help.aspx?helpid=149' target='_blank' style='color:green;'><b>(?)</b></a>",b3);if(bR||M||cS){b3.style.display="none";}}var a2=cs.insertCell(-1);a2.align="center";a2.style.width="90px";$ce("span","操作",a2);if(bo){for(var dF=1;dF<m._select.length;dF++){cZ[dF]=new creat_item(cA,dF,aW,"check",false,m._select[dF]);}}else{for(var dF=1;dF<m._select.length;dF++){cZ[dF]=new creat_item(cA,dF,aW,"radio",false,m._select[dF]);}}this.checkItemTitle=function(){var i=true;if(!this.checkEmptyItem()){return false;}if(!this.checkRepeatItem()){return false;}this.isItemTitleValid=true;return true;};this.checkEmptyItem=function(){var ek=true;for(var j=1;j<cZ.length;j++){var dw=cZ[j].get_item_title();if(trim(dw.value)==""){if(dw.initText){dw.value=dw.initText;}else{this.popHint("选项不能为空！");ek=false;this.isItemTitleValid=false;}}}return ek;};this.checkRepeatItem=function(){var en=true;for(var el=1;el<cZ.length;el++){var ek=cZ[el].get_item_title();if(ek._oldBorder||ek._oldBorder==""){ek.style.border=ek._oldBorder;ek.title=ek._oldTitle;}for(var dw=el+1;dw<cZ.length;dw++){if(trim(cZ[el].get_item_title().value)==trim(cZ[dw].get_item_title().value)){var em=cZ[dw].get_item_title();ek.rel=em;em.rel=ek;this.popHint("第"+el+"个选项与第"+dw+"个选项重复，请修改！");en=false;this.isItemTitleValid=false;return false;}}}return en;};this.checkItemValue=function(){var ek=true;if(P.checked){for(var dw=1;dw<cZ.length;dw++){var j=trim(cZ[dw].get_item_value().value);if(j==""){if(!cZ[dw].get_item_novalue()||!cZ[dw].get_item_novalue().checked){cZ[dw].get_item_value().value=0;}}else{if(!isInt(j)){this.popHint("选项的分数不合法，请修改！");ek=false;}}}}this.isItemValueValid=ek;return ek;};this.checkItemJump=function(dw){var em=true;if(c0&&c0.checked){var el;for(var j=1;j<cZ.length;j++){el=trim(cZ[j].get_item_jump().value);if(el!=""&&el!=0&&el!=1){var ek="";if(!isPositive(el)){ek="选项的跳转题号必须是正整数";}else{if(toInt(el)<=this.dataNode._topic){ek="跳转题号必须大于本题题号("+this.dataNode._topic+")";}else{if(toInt(el)>total_question){ek="跳转题号必须小于或等于最大题号("+total_question+")";}}}if(ek){this.popHint(ek);em=false;}}}}if(!dw){this.isItemJumpValid=em;}else{this.isItemJumpValid=false;}return em;};this.checkCeShiSet=function(){if(!this.dataNode._isCeShi){return true;}var j=false;for(var i=1;i<m._select.length;i++){if(m._select[i]._item_radio){j=true;}}if(!j){this.popHint("请设置此题的正确答案");}this.isCeShiValid=j;return j;};this.setItemJump=function(){for(var j=1;j<cZ.length;j++){cZ[j].get_item_jump().value=this.dataNode._select[j]._item_jump;}};b4.appendChild(aW);dc.appendChild(cq);$ce("div","",dc).className="divclear";var cy=$ce("span","",de);de.style.width="94%";if(bR){de.style.width="63%";}else{if(aX){de.style.width="71%";}else{if(dS){de.style.width="72%";}else{if(cU){de.style.width="72%";}else{if(bo&&ee){de.style.width="80%";}}}}}cy.className="spanLeft";if(cU||dS||bR||ee||bF||(isMergeAnswer&&!this.isMergeNewAdded)||ar||!dX){a8="";}var ah="<a href='javascript:cur.addNewItem();' class='titlelnk' style='text-decoration:none;'><span class='choiceimg design-icon design-add' ></span><b>添加选项</b></a>&nbsp;&nbsp;";var dQ="<a href='javascript:PDF_launch(\"oftenoptions.aspx\",540,400);' class='batchadd'><span class='choiceimg design-icon design-badd'></span><b>批量增加</b></a>&nbsp;";var q="";cy.innerHTML=ah+dQ+"&nbsp;"+a8;if(aX){cy.innerHTML=ah+dQ;}else{if(ar&&(this.dataNode._tag&&this.dataNode._tag<=101||this.dataNode._tag==102)){cy.innerHTML=dQ;}}if(isMergeAnswer&&!this.isMergeNewAdded){cy.innerHTML=ah;}var cM=$ce("span","",de);if((aI&&cW==0)||(bo&&!dS)){var ec=null;var y=document.createElement("span");var av="";var c5=1;if(aI&&!ee&&!bR&&!bF){av="<option value='0'>下拉菜单</option>";c5=2;}y.innerHTML="<select onchange='cur.checkNumPer(this);' style='width:90px;'><option value='1'>竖向排列</option>"+av+"<optgroup label='横向排列'><option value='2'>2</option><option value='3'>3</option><option value='4'>4</option><option value='5'>5</option><option value='6'>6</option><option value='7'>7</option><option value='8'>8</option><option value='9'>9</option><option value='10'>10</option><option value='11'>11</option><option value='12'>12</option><option value='15'>15</option><option value='20'>20</option><option value='30'>30</option></optgroup></select>&nbsp;";ec=$$("select",y)[0];for(var dG=c5;dG<ec.options.length;dG++){ec.options[dG].text="每行"+ec.options[dG].value+"列";}cM.appendChild(y);if(dS&&ec){y.style.display="none";}this.checkNumPer=function(dw){var i=trim(dw.value);if(i==0){this.selChangeType("radio_down");return;}this.dataNode._numperrow=parseInt(i);this.createTableRadio(true);this.focus();if(!this.applyNumber){var j=$ce("span","&nbsp;&nbsp;<a href='javascript:void(0);' class='link-U00a6e6' title='批量复制此属性到后面的题目'>批量复制</a>",cM);j.onclick=function(){var ek="/wjx/design/applynumrow.aspx";var el=cA.dataNode._topic;ek+="?ct="+el;PDF_launch(ek,500,250,null,"批量复制选项排列属性到后面的题目");};this.applyNumber=true;}};y.style.display="inline-block";}cM.className="spanRight";var Q=$ce("span","",de);var b6=control_check();Q.appendChild(b6);$ce("span","选项随机&nbsp;",Q);Q.className="spanRight";if(bR){var a=$ce("span","<a class='titlelnk' onclick='setAllRandom();' href='javascript:' title='复制随机属性到其它的考试题'>复制到其它考试题</a>&nbsp;",Q);a.style.display="none";this.get_random=function(){return b6;};}b6.onclick=function(){cA.dataNode._randomChoice=this.checked;if(bR){a.style.display="";}};if(aX||ar){Q.style.display="none";}if((bo&&!bR)||(ar&&cW=="102")){var bg=null;bg=$ce("span","",de);var at="至少选";if(ar){at="&nbsp;&nbsp;"+at;}$ce("span",at,bg);bg.className="spanRight";var da=document.createElement("span");var aK="<select onchange='cur.limitChange(this);' onclick='cur.lowLimitClick(this);' style='width:44px;'>";aK+="<option value=''> </option>";for(var dG=1;dG<m._select.length;dG++){aK+="<option value='"+dG+"'>"+dG+"</option>";}aK+="</select>";da.innerHTML=aK;var a6=document.createElement("span");a6.innerHTML="项&nbsp;最多选";var aP=document.createElement("span");var Y="<select onchange='cur.limitChange(this);' onclick='cur.upLimitClick(this);' style='width:44px;'>";Y+="<option value=''> </option>";for(var dG=2;dG<m._select.length;dG++){Y+="<option value='"+dG+"'>"+dG+"</option>";}Y+="</select>";aP.innerHTML=Y;var dA=document.createTextNode("项");bg.appendChild(da);bg.appendChild(a6);bg.appendChild(aP);bg.appendChild(dA);this.limitChange=function(){cA.checkCheckLimit();window.focus();};this.lowLimitClick=function(ek){if(m._select.length-1==ek.options.length-1){return;}ek.options.length=0;ek.options.add(new Option(" ",""));for(var dw=1;dw<m._select.length;dw++){var j=new Option(dw,dw);ek.options.add(j);}};this.upLimitClick=function(ek){if(m._select.length-1==ek.options.length){return;}ek.options.length=0;ek.options.add(new Option(" ",""));for(var dw=2;dw<m._select.length;dw++){var j=new Option(dw,dw);ek.options.add(j);}};var dN=m._lowLimit;var d7=m._upLimit;if(dS){if(!m._lowLimit){dN=m._lowLimit=m._select.length-1;}if(!m._upLimit){d7=m._upLimit=m._select.length-1;}if(m._lowLimit==-1){dN="";}if(m._upLimit==-1){d7="";}}$$("select",da)[0].value=dN||"";$$("select",aP)[0].value=d7||"";$ce("span","&nbsp;&nbsp;",bg);this.checkCheckLimit=function(){if(bo||(ar&&cW=="102")){var j=$$("select",da)[0].value;var dw=$$("select",aP)[0].value;var i=cZ.length-1;if(j!=""){if(dw!=""&&dw-j<0){j=dw;$$("select",da)[0].value=dw;show_status_tip("要求用户最多选中选项数量不合法！",4000);}if(!l.checked){show_status_tip("由于设置了选项数量限制，建议将该题设为必答",4000);}}else{if(dS){j=-1;}}if(dw!=""){if(j!=""&&dw-j<0){dw=j;$$("select",aP)[0].value=j;show_status_tip("要求用户最多选中选项数量不合法！",4000);}}else{if(dS){dw=-1;}}this.dataNode._lowLimit=j;this.dataNode._upLimit=dw;this.updateSpanCheck();}return true;};}$ce("div","",de).className="divclear";if(ar){b4.appendChild(d0);}else{dc.appendChild(d0);}this.initFreOptions=function(el){var ek="";var dw=/^选项\d+$/;var j=0;for(var i=1;i<cZ.length;i++){var em=trim(cZ[i].get_item_title().value);if(!em){continue;}if(dw.test(em)){continue;}if(j>0){ek+="\n";}ek+=em;j++;}if(ek){el.value=ek+"\n";}};this.setFreOptions=function(el){var em=el.split("\n");if(el=="每行一个选项，可以添加多个选项"){return;}var en=new Array();for(var ek=0;ek<em.length;ek++){if(em[ek]&&trim(em[ek])){en.push(em[ek]);}}for(var ek=en.length;ek<2;ek++){en[ek]="选项"+(ek+1);}for(var j=0;j<en.length;j++){if(cZ[j+1]){cZ[j+1].get_item_title().value=trim(en[j]);continue;}if(bo){cZ[j+1]=new creat_item(this,j+1,aW,"check",false,null);}else{cZ[j+1]=new creat_item(this,j+1,aW,"radio",false,null);}cZ[j+1].get_item_title().value=trim(en[j]);cZ[j+1].get_item_value().value=j+1;}var dw=cZ.length-1;for(var j=dw;j>en.length;j--){aW.deleteRow(j);cZ.length=cZ.length-1;}this.updateItem();this.setNotNewAdd();setQTopPos(this);};this.checkTextJump=function(dw){if((aI||cU)&&!c0.checked&&!hasInsPromoteJump){var j=/[一二三四五六七八九\d]+题/;var i=j.exec(dw);if(i){hasInsPromoteJump=true;if(window.confirm("您是否需要按选项设置此题的跳题逻辑？")){c0.click();}}}};this.updateItem=function(eo){var el=true;if(this.dataNode._type!="matrix"){this.popHint("");}if(!this.checkItemTitle()){el=false;}if(!this.checkItemValue()){el=false;}if(!this.checkItemJump(true)){el=false;}if(!el){return;}var en=this.dataNode;en._select=new Array();var ek=!en._tag&&(en._type=="check"||en._type=="radio"||en._type=="radio_down");for(var dw=1;dw<cZ.length;dw++){en._select[dw]=new Object();var em=cZ[dw].get_item_title();var i=replace_specialChar(trim(em.value));if(i!=em.value){em.value=i;}en._select[dw]._item_title=em.value.replace(/\</g,"&lt;");en._select[dw]._item_radio=false;if(ek||en._isCeShi){en._select[dw]._item_radio=cZ[dw].get_item_check().checked;}en._select[dw]._item_value=trim(cZ[dw].get_item_value().value);en._select[dw]._item_jump=0;if(aI||cU||cS){en._select[dw]._item_jump=trim(cZ[dw].get_item_jump().value);}if(cZ[dw].get_item_huchi()){en._select[dw]._item_huchi=cZ[dw].get_item_huchi().checked;}en._select[dw]._item_tb=false;en._select[dw]._item_tbr=false;en._select[dw]._item_img="";en._select[dw]._item_imgtext=false;en._select[dw]._item_desc="";en._select[dw]._item_label="";if(cZ[dw].get_item_tb()){en._select[dw]._item_tb=cZ[dw].get_item_tb().checked;}if(cZ[dw].get_item_tbr()){en._select[dw]._item_tbr=cZ[dw].get_item_tbr().checked;}if(cZ[dw].get_item_img()){en._select[dw]._item_img=cZ[dw].get_item_img().value=replace_specialChar(trim(cZ[dw].get_item_img().value));}if(cZ[dw].get_item_imgtext()){en._select[dw]._item_imgtext=cZ[dw].get_item_imgtext().checked;}if(cZ[dw].get_item_desc()){en._select[dw]._item_desc=cZ[dw].get_item_desc().value=replace_specialChar(trim(cZ[dw].get_item_desc().value));}if(cZ[dw].get_item_label()){en._select[dw]._item_label=cZ[dw].get_item_label().value=replace_specialChar(trim(cZ[dw].get_item_label().value));}}if(!this.checkCeShiSet()){return;}if(!eo){this.createTableRadio(true);}};}if(ar||u){var aE=$ce("div","",dc);aE.style.marginTop="15px";if(ar){var C=$ce("span","<b>题目总宽度：</b>",aE);var dK="<select onchange='cur.setMainWidth(this);'><option value=''>默认</option><option value='50'>50%</option><option value='60'>60%</option><option value='70'>70%</option><option value='80'>80%</option><option value='90'>90%</option><option value='100'>100%</option><option value='自定义'>自定义</option></select>&nbsp;";C.innerHTML+=dK;var aQ=$ce("span","",C);var a4=control_text("3");a4.maxLength=2;a4.onchange=a4.onblur=function(){var i=this.value;if(!isEmpty(i)&&!isInt(i)){show_status_tip("您输入的宽度不合法！");this.value="";cA.dataNode._mainWidth=50;}else{cA.dataNode._mainWidth=i?parseInt(i):"";}cA.createTableRadio(true);};this.setMainWidth=function(i){if(i.value!="自定义"){a4.value=i.value;aQ.style.display="none";a4.onchange();}else{aQ.style.display="";}};this.initMainWidth=function(){if(this.dataNode._mainWidth){a4.value=this.dataNode._mainWidth;var ek=$$("select",C)[0];ek.value=this.dataNode._mainWidth;var j=true;for(var dw=0;dw<ek.options.length;dw++){if(ek.options[dw].value==this.dataNode._mainWidth){j=false;break;}}if(j){ek.value="自定义";this.setMainWidth(ek);}}};aQ.appendChild(a4);aQ.appendChild(document.createTextNode("%"));aQ.style.display="none";if(cW=="102"){C.style.display="none";}}var du="左行标题宽度：";if(u){du="行标题宽度：";}var cv=$ce("span","&nbsp;&nbsp;<b>"+du+"</b>",aE);var cK="<select onchange='cur.setTWidth(this);'><option value=''>默认</option><option value='10%'>10%</option><option value='15%'>15%</option><option value='20%'>20%</option><option value='30%'>30%</option><option value='40%'>40%</option><option value='50%'>50%</option><option value='自定义'>自定义</option></select>&nbsp;";cv.innerHTML+=cK;var aU=control_text("3");aU.maxLength=3;aU.onchange=aU.onblur=function(){var i=this.value;if(!isEmpty(i)&&(!isInt(i)||i-100>0)){show_status_tip("您输入的宽度不合法！");this.value="";cA.dataNode._rowwidth="";}else{cA.dataNode._rowwidth=i+"%";if(cA.dataNode._rowwidth=="%"){cA.dataNode._rowwidth="";}}if(u){cA.createSum();}else{if(ar){cA.updateItem();}}window.focus();};this.setTWidth=function(i){if(i.value!="自定义"){aU.value=i.value.replace("%","");aU.style.display="none";aU.onchange();}else{aU.style.display="";}};this.initWidth=function(){if(this.dataNode._rowwidth&&this.dataNode._rowwidth.indexOf("%")>-1){var i=$$("select",cv)[0];i.value=this.dataNode._rowwidth;aU.value=this.dataNode._rowwidth.replace("%","");if(i.selectedIndex==-1){i.value="自定义";this.setTWidth(i);}}};aU.style.display="none";cv.appendChild(aU);if(ar){var aJ=$ce("span","<b>右行标题宽度：</b>",aE);aJ.style.display="none";var bX="<select onchange='cur.setTWidth2(this);'><option value=''>默认</option><option value='10%'>10%</option><option value='15%'>15%</option><option value='20%'>20%</option><option value='30%'>30%</option><option value='40%'>40%</option><option value='50%'>50%</option><option value='自定义'>自定义</option></select>&nbsp;";aJ.innerHTML+=bX;var dI=control_text("3");dI.maxLength=3;dI.onchange=dI.onblur=function(){var i=this.value;if(!isEmpty(i)&&(!isInt(i)||i-100>0)){show_status_tip("您输入的宽度不合法！");this.value="";cA.dataNode._rowwidth2="";}else{cA.dataNode._rowwidth2=i+"%";if(cA.dataNode._rowwidth2=="%"){cA.dataNode._rowwidth2="";}}cA.updateItem();window.focus();};this.setTWidth2=function(i){if(i.value!="自定义"){dI.value=i.value.replace("%","");dI.style.display="none";dI.onchange();}else{dI.style.display="";}};this.initWidth2=function(){if(this.dataNode._rowwidth2&&this.dataNode._rowwidth2.indexOf("%")>-1){var i=$$("select",aJ)[0];i.value=this.dataNode._rowwidth2;dI.value=this.dataNode._rowwidth2.replace("%","");if(i.selectedIndex==-1){i.value="自定义";this.setTWidth2(i);}}};dI.style.display="none";aJ.appendChild(dI);}if(ar&&(this.dataNode._tag==102||this.dataNode._tag==103)){var cF=control_check();aE.appendChild(cF);var h=$ce("span","竖向选择<a title='当选项太多时，通过竖向选择可以得到更好的显示效果' href='javascript:void(0);' style='color:green;'><b>(?)</b></a>",aE);cF.onclick=function(){if(cA._referDivQ){show_status_tip("使用引用逻辑后，不能再使用竖向选择",5000);return;}cA.dataNode._daoZhi=this.checked;cA.updateSpanMatrix();cA.updateItem();};$ce("span","&nbsp;&nbsp;",aE);var v=$ce("a","交换选项与行",aE);v.className="link-666";var bS=$ce("span","<a title='如果您将行与选项正好相反，可以“交换选项与行”。' href='javascript:void(0);' style='color:green;'><b>(?)</b></a>",aE);v.href="javascript:void(0);";v.onclick=function(){if(isMergeAnswer&&!cA.isMergeNewAdded){show_status_tip("在合并答卷模式下，不能“交换选项与行”",5000);return;}if(window.confirm("确定交换行与选项吗？")){var j="";var ek=cA.dataNode._select;for(var i=1;i<ek.length;i++){if(i>1){j+="\n";}j+=ek[i]._item_title;}var dw=eg.value;if(dw){eg.value=j;cA.checkRowTitle();cA.setFreOptions(dw);}}};}}if(ar){b4.style.width="310px";if(cW=="102"||cW=="103"){b4.style.width="350px";}if(cW&&cW<=101){b4.style.width="390px";}if(cW=="303"){b4.style.width="295px";}b4.style.paddingTop="5px";aW.cellSpacing="0";aW.cellPadding="2";aW.width="98%";setFloat(b4);setFloat(bx);$ce("div","",cq).style.clear="both";if(cW=="201"){var dD=document.createElement("div");var c8=document.createElement("span");dD.appendChild(c8);this.refreshSelRow=function(){var eo=this.dataNode;var el=trim(eo._rowtitle).split("\n");var en="";var em=0;for(var ek=0;ek<el.length;ek++){if(el[ek].substring(0,4)=="【标签】"){continue;}var dw="<option value='"+em+"'>第"+(em+1)+"行:"+el[ek]+"</option>";em++;en+=dw;}c8.innerHTML="<b>行属性</b>：<select style='width:200px;'><option value='-1'>请选择行</option>"+en+"</select>&nbsp;";var j=$$("select",c8)[0];j.onchange=function(){var eq=this.value;var ep=parseInt(eq);cO.style.display=ep<0?"none":"";var i=$$("select",cO)[0];if(!cA.dataNode._rowVerify||!cA.dataNode._rowVerify[ep]){i.value="0";au.value="";eb.value="";bf.value="";return;}i.value=cA.dataNode._rowVerify[ep]._verify||"0";au.value=cA.dataNode._rowVerify[ep]._minword||"";eb.value=cA.dataNode._rowVerify[ep]._maxword||"";bf.value=cA.dataNode._rowVerify[ep]._width||"";};};this.refreshSelRow();dD.style.margin="10px 0 0 15px";aB.appendChild(dD);var cO=document.createElement("span");cO.style.display="none";var aD=getVerifyHtml(0);cO.innerHTML=aD;dD.appendChild(cO);this.setVerify=function(dw){if(!this.dataNode._rowVerify){this.dataNode._rowVerify=new Array();}var i=$$("select",c8)[0];var el=i.value;var ek=parseInt(el);if(!cA.dataNode._rowVerify[ek]){cA.dataNode._rowVerify[ek]=new Object();}var j=this.dataNode._rowVerify[ek]._verify;this.dataNode._rowVerify[ek]._verify=dw.value;if(dw.value=="数字"||dw.value=="小数"){aC.innerHTML=aC.innerHTML.replace("字数","值");aj.innerHTML=aj.innerHTML.replace("字数","值");ag="值";}else{aC.innerHTML=aC.innerHTML.replace("值","字数");aj.innerHTML=aj.innerHTML.replace("值","字数");ag="字数";}this.updateItem();};this.initVerify=function(){var j=this.dataNode._verify||"0";var i=$$("select",cO)[0];i.value=j;};var z=$ce("span","&nbsp;宽度：",cO);var cT="<select onchange='cur.setMatrixItemWidth(this);'><option value=''>默认</option>";for(var dG=1;dG<9;dG++){var cp=dG*10;cT+="<option value='"+cp+"'>"+cp+"%</option>";}cT+="</select>";var a5=$ce("span",cT,cO);var bf=$$("select",a5)[0];this.setMatrixItemWidth=function(j){if(!cA.dataNode._rowVerify){cA.dataNode._rowVerify=new Array();}var i=$$("select",c8)[0];var ek=i.value;var dw=parseInt(ek);if(dw==-1){alert("请选择行");return;}if(!cA.dataNode._rowVerify[dw]){cA.dataNode._rowVerify[dw]=new Object();}cA.dataNode._rowVerify[dw]._width=j.value;this.updateItem();};var aZ=$ce("span","&nbsp;",cO);var ag="字数";if(m._verify=="数字"||m._verify=="小数"){ag="值";}var aC=$ce("span","最小"+ag+"：",aZ);var au=control_text("4");au.title="不填表示无限制";aZ.appendChild(au);au.onchange=au.onblur=function(){var j=$$("select",c8)[0];var dw=j.value;var ek=parseInt(dw);if(!cA.dataNode._rowVerify[ek]){cA.dataNode._rowVerify[ek]=new Object();}var i=checkVerifyMinMax(au,eb,cA.dataNode._rowVerify[ek]._verify);if(i){show_status_tip(i,4000);this.value="";}cA.dataNode._rowVerify[ek]._minword=this.value;};var aj=$ce("span","最大"+ag+"：",aZ);aj.style.marginLeft="10px";var eb=control_text("4");eb.title="不填表示无限制";eb.onchange=eb.onblur=function(){var j=$$("select",c8)[0];var dw=j.value;var ek=parseInt(dw);if(!cA.dataNode._rowVerify[ek]){cA.dataNode._rowVerify[ek]=new Object();}var i=checkVerifyMinMax(au,eb,cA.dataNode._rowVerify[ek]._verify);if(i){show_status_tip(i,4000);this.value="";}cA.dataNode._rowVerify[ek]._maxword=this.value;};aZ.appendChild(eb);}}var cC=$ce("div","&nbsp;",aB);cC.style.clear="both";cC.style.lineHeight="1px";if(m._isShop){var cV=$ce("div","<div style='margin:10px 0 10px 18px;font-size:14px'><b style='color:#ff9900;'>商品支付方式:</b>&nbsp;&nbsp;<a href='/wjx/design/setactivitywpay.aspx?activity="+activityID+"' class='titlelnk' target='_blank'>设置微信支付</a></div>",aB);}var c1=document.createElement("div");c1.style.margin="10px 0px";var bb=control_btn("完成编辑");bb.className="submitbutton";bb.style.width="100%";bb.onclick=function(){qonclick.call(cA);};if(this.newAddQ){}c1.appendChild(bb);var o=$ce("span","",c1);o.style.color="red";o.style.fontSize="14px";o.style.display="inline-block";o.style.marginLeft="10px";aB.appendChild(c1);B.appendChild(aF);this.hasCreatedAttr=true;this.createEditBox=function(){if(this.hasEditBox){return;}this.hasEditBox=true;if(ab){ab.style.display="none";}G.style.height="102px";G.style.width="400px";var i=EditToolBarItemsPageCut;if(ef){i=EditToolBarItems;}else{G.style.height="152px";}KE.init({id:w,items:i,filterMode:filter,afterChange:function(j){KE.util.setData(j);},DesignPage:1});this.titleId=w;KE.create(w);KE.util.focus(w);};this.popHint=function(i){if(o){if(i){o.innerHTML="<b>提示：</b>"+i;}else{o.innerHTML="";}}};if(c){this.createEditBox();}this.checkTitle=function(){if(dY){var i=getGapFillCount(G.value);if(i==0){show_status_tip("填空题的标题必须包含空“"+GapFillStr+"”!",4000);this.isTitleValid=false;return false;}else{if(isMergeAnswer&&!cA.isMergeNewAdded){if(i<this.dataNode._gapcount){show_status_tip("合并答卷时，不能删除填空题标题中的空!",4000);this.isTitleValid=false;return false;}}}}var dw=G.value;if(!this.hasEditBox&&/\r\n|\n|\r/.test(dw)){dw=G.value=dw.replace(/\r\n|\n|\r/g,"<br />");d9.onclick();}if(dY){dw=replaceGapFill(dw,this.dataNode);}aa.innerHTML=dw;this.dataNode._title=G.value;this.isTitleValid=true;if(this.dataNode._type=="cut"){aa.innerHTML=dw||"请在此输入说明文字";if(this.div_video_title){this.div_video_title.innerHTML="";}if(this.dataNode._video){var j="<iframe height=498 width=510 src='"+this.dataNode._video+"' frameborder=0 allowfullscreen></iframe>";if(this.div_video_title){this.div_video_title.innerHTML=j;}else{this.div_video_title=$ce("div",j,aa);}}}if(!this.hasEditBox&&dw.indexOf("<")>-1){this.createEditBox();}return true;};this.checkDefault=function(){this.popHint("");var i=replace_specialChar(trim(bQ.value));bQ.value=i;if(au.value!=""&&i!=""&&i.length<au.value){this.popHint("您输入的默认值少于您设置的最小字数，请修改！");this.isDefaultValid=false;return false;}else{if(eb.value!=""&&i.length>eb.value){this.popHint("您输入的默认值超过了您设置的最大字数，请修改！");this.isDefaultValid=false;return false;}else{if(this.dataNode._verify!="省市区"&&this.dataNode._verify!="高校"){bZ.value=i;}else{if(i){bZ.value="指定省份为："+i;}else{bZ.value="";}}this.dataNode._default=i;this.isDefaultValid=true;}}return true;};this.checkAnyJump=function(j){if(bU.checked){var ek;var i=toInt(this.dataNode._topic);ek=trim(bE.value);this.popHint("");if(ek!=1&&ek!=""&&ek!="0"){var dw="";if(!isPositive(ek)){dw="跳转题号必须为正整数";}else{if(toInt(ek)<=i){dw="跳转题号必须大于本题题号("+i+")";}else{if(toInt(ek)>total_question){dw="跳转题号必须小于或等于最大题号("+total_question+")";}}}if(dw){this.popHint(dw);this.isAnyJumpValid=false;return false;}else{this.dataNode._hasjump=true;}}else{if(ek==1){this.dataNode._hasjump=true;}else{this.dataNode._hasjump=false;}}cA.set_jump_ins();}if(this.isAnyJumpValid==true||this.isAnyJumpValid==undefined){if(bE._oldBorder||bE._oldBorder==""){bE.style.border=bE._oldBorder;bE.title=bE._oldTitle;}}if(!j){this.isAnyJumpValid=true;}else{this.isAnyJumpValid=false;}this.dataNode._anytimejumpto=trim(bE.value);return true;};this.setAnyTimeJumpTo=function(){bE.value=this.dataNode._anytimejumpto;};this.checkValid=function(){var el=this.isAnyJumpValid==undefined||this.isAnyJumpValid;var em=this.isTitleValid==undefined||this.isTitleValid;if(cH){var j=this.isDefaultValid==undefined||this.isDefaultValid;return em&&j&&el;}else{var ep=this.isItemTitleValid==undefined||this.isItemTitleValid;var i=this.isItemJumpValid==undefined||this.isItemJumpValid;var dw=this.isItemValueValid==undefined||this.isItemValueValid;var ek=this.isRowTitleValid==undefined||this.isRowTitleValid;var en=this.isColumnTitleValid==undefined||this.isColumnTitleValid;var eo=this.isCeShiValid==undefined||this.isCeShiValid;return ep&&i&&dw&&el&&em&&ek&&en&&eo;}};this.validate=function(){o.innerHTML="";this.checkTitle();if(cH){this.checkDefault();}else{if(u){this.checkRowTitle();}else{if(dW){if(ar){this.checkRowTitle();}if(b0){this.checkColumnTitle();}this.checkItemTitle();this.checkItemValue();this.checkItemJump();if(this.checkCheckLimit){this.checkCheckLimit();}if(this.checkCeShiSet){this.checkCeShiSet();}}}}if(ef){this.checkAnyJump();}this.setErrorStyle();};this.setErrorStyle=function(){if(!this.checkValid()){this.className+=" div_question_error";}else{this.className=this.className.replace(/div_question_error/,"");}};this.setDataNodeToDesign=function(){var em=this.dataNode;switch(em._type){case"question":if(em._verify=="多级下拉"){break;}G.value=em._title;G.onblur();eb.value=em._maxword;l.checked=em._requir;bQ.value=em._default;if(em._default){em._olddefault=em._default;A.click();}d1.value=em._ins;if(em._hasjump){bU.click();}bE.value=em._anytimejumpto;cu.checked=em._needOnly;bY.checked=em._needsms;aU.value=em._width;if(em._underline){cn.checked=true;}au.value=em._minword;this.initVerify();this.initWidth();this.initHeight();break;case"sum":G.value=em._title;G.onblur();l.checked=em._requir;eg.value=em._rowtitle;cQ.value=em._total;d1.value=em._ins;if(em._hasjump){bU.click();}bE.value=em._anytimejumpto;if(this._referDivQ){this.show_divAddFromCheck();bq.value=this._referDivQ.dataNode._topic;this.addFromCheck(bq);}break;case"cut":case"page":G.value=em._title;G.onblur();if(em._type=="page"){s.checked=em._iszhenbie;bn.value=em._mintime;dz.value=em._maxtime;dz.onblur();}break;case"fileupload":G.value=em._title;G.onblur();var eq=$$("input",dU);var es=em._ext||defaultFileExt;J.value=em._maxsize;var el=es.split("|");for(var et=0;et<eq.length;et++){eq[et].onclick=function(){if(!this.value){var ez=this.parentNode;var ey=$$("input",ez);for(var ex=0;ex<ey.length;ex++){if(ey[ex]!=this){ey[ex].checked=this.checked;}}}if(cur.updateExt){cur.updateExt(this);}};if(el.indexOf(eq[et].value)>-1){eq[et].checked=true;}}for(var et=0;et<eq.length;et++){if(eq[et].value){continue;}var ew=true;var ep=eq[et].parentNode;var en=$$("input",ep);for(var j=0;j<en.length;j++){if(en[j]!=eq[et]&&!en[j].checked){ew=false;break;}}if(ew){eq[et].checked=true;}}l.checked=em._requir;d1.value=em._ins;if(em._hasjump){bU.click();}bE.value=em._anytimejumpto;break;case"gapfill":G.value=em._title;G.onblur();l.checked=em._requir;d1.value=em._ins;if(em._hasjump){bU.click();}bE.value=em._anytimejumpto;dm.checked=em._useTextBox;break;case"slider":G.value=em._title;G.onblur();l.checked=em._requir;aG.value=em._minvalue||0;d.value=em._maxvalue||100;cd.value=em._minvaluetext||"";aq.value=em._maxvaluetext||"";d1.value=em._ins;if(em._hasjump){bU.click();}bE.value=em._anytimejumpto;break;case"radio":case"radio_down":case"check":case"matrix":G.value=em._title;G.onblur();d1.value=em._ins;if(ec){ec.value=em._numperrow;}b6.checked=em._randomChoice;if(em._hasvalue){P.checked=true;P.onclick();}if(em._tag){P.disabled=true;}if(em._type=="matrix"){this.initMainWidth();eg.value=em._rowtitle;this.initWidth();if(em._rowtitle2&&cB){cB.checked=true;cB.onclick();cB.checked=true;}if(em._rowwidth2){this.initWidth2();}if(em._daoZhi){if(cF){cF.checked=true;}}d0.style.display=(em._tag>200&&em._tag!="303")?"none":"";b4.style.display=d0.style.display;P.disabled=(em._tag<=101||em._tag==303)?true:false;}var eo=false;var ek=!em._tag&&(em._type=="check"||em._type=="radio"||em._type=="radio_down");for(var dw=1;dw<em._select.length;dw++){cZ[dw].get_item_title().value=em._select[dw]._item_title.replace(/&lt;/,"<");if(ek||em._isCeShi){var i=em._select[dw]._item_radio;cZ[dw].get_item_check().checked=i;if(i){eo=true;}if(em._select[dw]._item_huchi){cZ[dw].get_item_huchi().checked=true;}}if(eo&&this.defaultCheckSet){this.defaultCheckSet();}var eu=em._select[dw]._item_value;if(em._isShop&&(eu=="0"||!eu)){eu="10";}cZ[dw].get_item_value().value=eu;if(eu==NoValueData){cZ[dw].get_item_value().value="";if(cZ[dw].get_item_novalue()){cZ[dw].get_item_novalue().checked=true;}}var ev=em._select[dw]._item_jump;cZ[dw].get_item_jump().value=ev;if(cZ[dw].get_item_tb()){cZ[dw].get_item_tb().checked=em._select[dw]._item_tb;}if(cZ[dw].get_item_tbr()){cZ[dw].get_item_tbr().checked=em._select[dw]._item_tbr;}if(cZ[dw].get_item_img()){cZ[dw].get_item_img().value=em._select[dw]._item_img;}if(cZ[dw].get_item_imgtext()){cZ[dw].get_item_imgtext().checked=em._select[dw]._item_imgtext;}if(cZ[dw].get_item_desc()){cZ[dw].get_item_desc().value=em._select[dw]._item_desc;}if(cZ[dw].get_item_label()){cZ[dw].get_item_label().value=em._select[dw]._item_label;}}l.checked=em._requir;if(em._hasjump){if(em._type=="radio"||em._type=="radio_down"){if(em._anytimejumpto<1){c0.click();}else{bU.click();}}else{bU.click();}}bE.value=em._anytimejumpto;if(this._referDivQ){this.show_divAddFromCheck();bq.value=this._referDivQ.dataNode._topic;this.addFromCheck(bq);}break;}if(em._ins){em._oldins=em._ins;aA.click();aA.checked=true;}try{G.focus();}catch(er){}};}function setImage(b,a){PDF_close(b);}function creat_item(H,L,A,ag,F,I){var R=L;var W;var k=A.insertRow(R);var s=k.insertCell(-1);var a=control_text("15");a.tabIndex=1;a.title="回车添加新选项，上下键编辑前后选项";if(F){select_item_num++;}a.value=I?I._item_title:"选项"+select_item_num;if(A.rows.length-1==R&&cur&&(cur.dataNode._isQingJing||cur.dataNode._isShop)){var B="情景"+R;if(cur.dataNode._isShop){B="商品"+R;}var O=false;for(var Z=1;Z<cur.dataNode._select.length;Z++){if(cur.dataNode._select[Z]._item_title==B){O=true;break;}}if(!O){a.value=B;}}a.className+=" choicetxt";a.onchange=a.onblur=function(){if(!this.value){this.value=this.initText||"";}if(cur&&cur.updateItem){cur.updateItem();cur.checkTextJump(this.value);}};a.onfocus=function(){if(!this.initText){this.initText=this.value;}var j=/^选项\d+$/;if(j.test(this.value)){this.value="";}};a.onkeydown=function(ah){var j=ah||window.event;if(j.keyCode==13){X.onclick();}else{if(j.keyCode==40){if(R<cur.option_radio.length-1){cur.option_radio[R+1].get_item_title().focus();cur.option_radio[R+1].get_item_title().select();}}else{if(j.keyCode==38){if(R>1){cur.option_radio[R-1].get_item_title().focus();cur.option_radio[R-1].get_item_title().select();}}}}return true;};s.appendChild(a);s.style.width="150px";var u=cur||H;var i=u.dataNode._isCePing;if(u.dataNode._type=="matrix"&&u.dataNode._tag&&u.dataNode._tag<=101){s.style.width="100px";a.style.width="100px";}else{if(u.dataNode._type=="matrix"&&u.dataNode._tag=="303"){s.style.width="120px";a.style.width="120px";}}var Q=!u.dataNode._tag&&(u.dataNode._type=="check"||u.dataNode._type=="radio")&&!i;var b=u.dataNode._isCeShi;var o=u.dataNode._isQingJing;var v=u.dataNode._isShop;if((Q||i)&&!o){var y=k.insertCell(-1);if(v){y.align="center";}var ae=document.createElement("input");ae.type="hidden";ae.value=I?I._item_img:"";y.appendChild(ae);var P=document.createElement("span");P.title="添加图片";P.className="choiceimg design-icon design-img";y.appendChild(P);P.style.border=ae.value?"2px #ffff66 solid":"";if(ae.value){A.rows[0].cells[1].style.width="50px";}function p(ah){if(ah==undefined){return;}var j=cur.option_radio[R].get_item_img();j.value=ah;if(!v){cur.option_radio[R].get_item_imgtext().parentNode.style.display=(ah)?"":"none";}P.style.border=ah?"2px #ffff66 solid":"";A.rows[0].cells[1].style.width="47px";cur.updateItem();}P.onclick=function(){itemImage=cur.option_radio[R].get_item_img().value;PDF_launch("uploadimg.aspx?design=1",650,460,p,cur.option_radio[R].get_item_title().value);};var S=$ce("span","",y);var ad=control_check();S.style.verticalAlign="bottom";ad.title="是否显示选项文字";S.appendChild(ad);S.style.display=ae.value?"":"none";if(v){S.style.display="none";}ad.onclick=function(){cur.updateItem();};}if((Q||i)&&!v){var T=k.insertCell(-1);var E=document.createElement("span");E.title="选项说明，支持HTML，图片，视频等";E.className="choiceimg design-icon design-desc";T.appendChild(E);var g=document.createElement("input");g.type="hidden";g.value=I?(I._item_desc||""):"";T.appendChild(g);E.style.border=g.value?"2px #ffff66 solid":"";E.onclick=function(){openTitleEditor(g,function(ah){if(ah=="-1nc"||ah==undefined){return;}g.value=trim(ah);var j="";E.style.border=g.value?"2px #ffff66 solid":"";if(!o){j=cur.option_radio[R].get_item_img().value;cur.option_radio[R].get_item_imgtext().parentNode.style.display=(j)?"":"none";}cur.updateItem();if(j){setTimeout(function(){cur.updateItem();},20);}},cur.option_radio[R].get_item_title().value);};}if(Q||(u.dataNode._type=="matrix"&&(u.dataNode._tag=="102"||u.dataNode._tag=="103"||u.dataNode._tag=="101"))||i){var x=k.insertCell(-1);var U=$ce("span","",x);U.style.verticalAlign="bottom";var t=control_check();t.style.verticalAlign="bottom";t.title="允许填空";U.appendChild(t);t.checked=I?I._item_tb:false;var ac=$ce("span","&nbsp;",U);var m=control_check();m.title="文本框必填";ac.appendChild(document.createTextNode("必填"));ac.appendChild(m);m.checked=I?I._item_tbr:false;ac.style.visibility=t.checked?"visible":"hidden";t.onclick=function(){if(!this.checked){cur.option_radio[R].get_item_tbr().checked=false;}cur.option_radio[R].get_item_tbr().parentNode.style.visibility=this.checked?"visible":"hidden";cur.updateItem();};m.onclick=function(){cur.updateItem();};if(b||o||v){x.style.display="none";}}var z=k.insertCell(-1);z.align="left";var d=$ce("span","&nbsp;",z);var n=control_text("4");n.maxLength=5;n.title="在此可以设置每个选项的分数（请输入整数）";if(o){n.title="请设置每个情景需要的数量,0表示不限制";}else{if(v){n.title="设置商品价格";}}n.value=I?I._item_value:R;d.appendChild(n);if(u.dataNode._hasvalue&&(i||u.dataNode._tag)){z.style.display="";if(u.dataNode._type!="check"&&u.dataNode._tag!="303"){var af=control_check();af.title="不记分";af.onclick=function(){n.value="";cur.updateItem();};n.style.width="25px";z.appendChild(af);$ce("span","不记分",z);}}else{if(!o&&!v){z.style.display="none";}}n.onchange=n.onblur=function(){if(i||(cur.dataNode._type=="radio"&&cur.dataNode._tag)){cur.updateItem();}else{cur.updateItem(true);}};n.onkeydown=function(ah){var j=ah||window.event;if(j.keyCode==13){X.onclick();}else{if(j.keyCode==40){if(R<cur.option_radio.length-1){cur.option_radio[R+1].get_item_value().select();}}else{if(j.keyCode==38){if(R>1){cur.option_radio[R-1].get_item_value().select();}}}}};var l=k.insertCell(-1);if(H.dataNode._type=="matrix"){l.style.display="none";}var K=$ce("span","&nbsp;&nbsp;",l);l.align="left";var G=control_text(3);G.maxLength=4;if(v){G.title="为空表示不限制库存，0表示已售完";}G.value=I?I._item_jump:"";if(u.dataNode._hasjump&&u.dataNode._anytimejumpto=="0"){K.style.display="";}else{if(v){K.style.display="";}else{K.style.display="none";}}K.appendChild(G);G.onclick=function(){if(!v){openJumpWindow(u,this);}};G.onmouseout=function(){if(!v){sb_setmenunav(toolTipLayer,false);}};G.onmouseover=function(){if(!v){if(!this.error){if(!this.title||this.hasChanged){this.title=getJumpTitle(this.value);}}}};G.onblur=function(){if(v&&!vipUser){alert("提示：库存功能仅对企业版开放！");this.value="";return;}if(this.value==this.prevValue){this.hasChanged=false;return;}this.hasChanged=true;this.prevValue=this.value;cur.updateItem(true);};G.onkeydown=function(ah){var j=ah||window.event;if(j.keyCode==13){X.onclick();}else{if(j.keyCode==40){if(R<cur.option_radio.length-1){cur.option_radio[R+1].get_item_jump().select();}}else{if(j.keyCode==38){if(R>1){cur.option_radio[R-1].get_item_jump().select();}}}}};var C=null;if(Q&&ag=="check"&&!b&&!v){var N=k.insertCell(-1);var w=$ce("span","&nbsp;",N);N.align="left";C=control_check();C.title="与其它选项互斥";w.appendChild(C);C.onclick=function(){cur.updateItem();};}var f=k.insertCell(-1);var M=$ce("span","&nbsp;",f);f.align="left";var aa=null;aa=control_check();if(!b){aa.title="若选中，用户在填问卷时此选项会默认被选中";}if((Q||u.dataNode._type=="radio_down")&&!o&&!v){f.style.display="";}else{f.style.display="none";}M.appendChild(aa);if((Q||u.dataNode._type=="radio_down")&&ag=="radio"){aa.onclick=function(){if(this.checked){for(var j=1;j<cur.option_radio.length;j++){if(cur.option_radio[j].get_item_check()==this){this.checked=true;}else{cur.option_radio[j].get_item_check().checked=false;}}}cur.updateItem();};}if(Q&&ag=="check"){aa.onclick=function(){cur.updateItem();};}if(Q){var h=k.insertCell(-1);h.align="left";h.style.width="80px";var Y=$ce("a","分组",h);Y.tabIndex="-1";Y.className="link-666";if(cur&&cur.dataNode._select[R]&&cur.dataNode._select[R]._item_label){Y.innerHTML="编辑";}Y.href="javascript:void(0);";var r=document.createElement("input");r.type="hidden";r.value=I?(I._item_label||""):"";h.appendChild(r);Y.onclick=function(){if(!vipUser){alert("只有企业版用户才能插入分组，请升级！");return;}openTitleEditor(r,function(j){if(j=="-1nc"||j==undefined){return;}r.value=trim(j);Y.innerHTML=r.value?"编辑":"分组";cur.updateItem();});};if(b||o||v){h.style.display="none";}}var J=k.insertCell(-1);var X=document.createElement("span");X.title="在此选项下面插入一个新的选项";X.className="choiceimg design-icon design-add";var e=document.createElement("span");e.title="删除当前选项（最少保留2个选项）";e.className="choiceimg design-icon design-minus";var V=document.createElement("span");V.title="将当前选项上移一个位置";V.className="choiceimg design-icon design-up";var D=document.createElement("span");D.title="将当前选项下移一个位置";D.className="choiceimg design-icon design-down";J.appendChild(X);J.appendChild(e);J.appendChild(V);J.appendChild(D);X.style.cursor="pointer";e.style.cursor="pointer";V.style.cursor="pointer";D.style.cursor="pointer";X.onclick=function(){if(isMergeAnswer&&!cur.isMergeNewAdded&&R<cur.option_radio.length-1){alert("合并答卷模式下编辑问卷原始题目不能在中间插入选项！");return;}if(isMergeAnswer&&!cur.isMergeNewAdded&&!confirm("此题不能删除选项，是否确认增加选项？")){return;}for(var j=cur.option_radio.length-1;j>R;j--){cur.option_radio[j].set_item_num(j+1);cur.option_radio[j+1]=cur.option_radio[j];}if(ag=="radio"){cur.option_radio[R+1]=new creat_item(cur,R+1,A,"radio",true);}if(ag=="check"){cur.option_radio[R+1]=new creat_item(cur,R+1,A,"check",true);}cur.updateItem();cur.option_radio[R+1].get_item_title().select();};e.onclick=function(){if(isMergeAnswer&&!cur.isMergeNewAdded){alert("很抱歉，在以合并答卷模式下修改问卷为了保持数据一致性不允许删除原始题目的选项！");return;}if(cur.option_radio.length>3){A.deleteRow(R);for(var ah=R+1;ah<cur.option_radio.length;ah++){cur.option_radio[ah].set_item_num(ah-1);cur.option_radio[ah-1]=cur.option_radio[ah];}cur.option_radio.length--;cur.updateItem();}else{show_status_tip("选择题至少要有两个选项",4000);}};V.onclick=function(){if(isMergeAnswer&&!cur.isMergeNewAdded){alert("很抱歉，在以合并答卷模式下修改问卷为了保持数据一致性不允许移动原始题目的选项！");return;}if((R-1)>0){c(cur.option_radio[R],cur.option_radio[R-1]);if(ag=="check"||ag=="radio"){ab(cur.option_radio[R],cur.option_radio[R-1]);}q(cur.option_radio[R],cur.option_radio[R-1]);cur.updateItem();}};D.onclick=function(){if(isMergeAnswer&&!cur.isMergeNewAdded){alert("很抱歉，在以合并答卷模式下修改问卷为了保持数据一致性不允许移动原始题目的选项！");return;}if((R+1)<cur.option_radio.length){c(cur.option_radio[R],cur.option_radio[R+1]);if(ag=="check"||ag=="radio"){ab(cur.option_radio[R],cur.option_radio[R+1]);}q(cur.option_radio[R],cur.option_radio[R+1]);cur.updateItem();}};function c(ai,j){var ah=ai.get_item_title().value;ai.get_item_title().value=j.get_item_title().value;j.get_item_title().value=ah;}function ab(ai,j){var ah=ai.get_item_check().checked;ai.get_item_check().checked=j.get_item_check().checked;j.get_item_check().checked=ah;}function q(ai,j){var ah=ai.get_item_value().value;ai.get_item_value().value=j.get_item_value().value;j.get_item_value().value=ah;ah=ai.get_item_jump().value;ai.get_item_jump().value=j.get_item_jump().value;j.get_item_jump().value=ah;if(ai.get_item_novalue()){ah=ai.get_item_novalue().checked;ai.get_item_novalue().checked=j.get_item_novalue().checked;j.get_item_novalue().checked=ah;}if(ai.get_item_tb()){ah=ai.get_item_tb().checked;ai.get_item_tb().checked=j.get_item_tb().checked;j.get_item_tb().checked=ah;}if(ai.get_item_tbr()){ah=ai.get_item_tbr().checked;ai.get_item_tbr().checked=j.get_item_tbr().checked;j.get_item_tbr().checked=ah;}if(ai.get_item_img()){ah=ai.get_item_img().value;ai.get_item_img().value=j.get_item_img().value;j.get_item_img().value=ah;}if(ai.get_item_imgtext()){ah=ai.get_item_imgtext().checked;ai.get_item_imgtext().checked=j.get_item_imgtext().checked;j.get_item_imgtext().checked=ah;}if(ai.get_item_desc()){ah=ai.get_item_desc().value;ai.get_item_desc().value=j.get_item_desc().value;j.get_item_desc().value=ah;}if(ai.get_item_label()){ah=ai.get_item_label().value;ai.get_item_label().value=j.get_item_label().value;j.get_item_label().value=ah;}}this.get_item_add=function(){return X;};this.get_item_del=function(){return e;};this.get_item_table=function(){return W;};this.get_item_tr=function(){return k;};this.set_item_num=function(j){R=j;};this.get_item_num=function(){return R;};this.get_item_title=function(){return a;};this.get_item_check=function(){return aa;};this.get_item_huchi=function(){return C;};this.get_item_tb=function(){return t;};this.get_item_tbr=function(){return m;};this.get_item_img=function(){return ae;};this.get_item_desc=function(){return g;};this.get_item_label=function(){return r;};this.get_item_imgtext=function(){return ad;};this.get_item_value=function(){return n;};this.get_item_novalue=function(){return af;};this.get_item_jump=function(){return G;};return true;}function setAllRequired(c){for(var a=0;a<questionHolder.length;a++){var b=questionHolder[a].dataNode._type;if(b!="cut"&&b!="page"&&questionHolder[a].dataNode._requir!=c){if(questionHolder[a].get_requir){questionHolder[a].get_requir().checked=c;}questionHolder[a].dataNode._requir=c;questionHolder[a].setreqstatus();}}show_status_tip("设置成功！",4000);}function setAllRandom(){var a=cur.dataNode._randomChoice;for(var b=0;b<questionHolder.length;b++){if(!questionHolder[b].dataNode._isCeShi){continue;}if(questionHolder[b].dataNode._type=="question"){continue;}if(questionHolder[b].get_random){questionHolder[b].get_random().checked=a;}questionHolder[b].dataNode._randomChoice=a;}show_status_tip("设置成功！",4000);}initAttrHandler();function initAttrHandler(){firstPage.createAttr=createAttr;for(var b=0;b<questionHolder.length;b++){var a=questionHolder[b];setAttrHander(a);}}function setAttrHander(a){a.createAttr=createAttr;}