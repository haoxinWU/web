





<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>

    <meta name="viewport" content="target-densitydpi=device-dpi,width=640">

    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="format-detection" content="telephone=no"/>
    <!-- 新浪新闻定制分享meta -->

    <title>武侠情怀&mdash;&mdash;《箭士柳白猿》</title>

    <script>
        /* Fix viewport*/
        (function(f,u){var o=navigator.userAgent,r=640,e=f.innerWidth||r,g=f.outerHeight||e,q=f.screen.width||e,d=f.screen.availWidth||e,n=f.innerHeight||r,p=f.outerHeight||n,a=f.screen.height||n,k=f.screen.availHeight||n,l=Math.min(e,g,q,d,n,p,a,k),h=l/r,b=f.devicePixelRatio;h=Math.min(h,b);if(h<1){var t=",initial-scale="+h+",maximum-scale="+h,c=u.getElementsByTagName("meta"),j;if(/iphone|ipod/ig.test(o)){j=",user-scalable=no"}if(/android/ig.test(o)){j=""}t+=j||"";if(/zenlife-android-webview/.test(o)&&!/viewport/.test(o)){document.querySelector('html').style.zoom = h}if(top.location!=location){document.querySelector('html').style.zoom = h};for(var s=0,m;s<c.length;s++){m=c[s];if(m.name=="viewport"){m.content+=t}}}}).call(this,window,document);
    </script>

    <link rel="stylesheet" href="http://yun.duiba.com.cn/webapp/css/normalize.css">


    <link rel="stylesheet" href="http://yun.duiba.com.cn/webapp/css/scratchCard-v1201.css">


    <link rel="stylesheet" href="http://yun.duiba.com.cn/webapp/css/activeRecommand.css">
</head>
<body>
<div id="db-content">





























    <!-- 她社区定制 -->


    <!-- 爱卡无线定制 -->


    <!-- 凤凰新闻定制，修复分享问题 -->

    <img src="http://yun.duiba.com.cn/images/201603/a57icwjcod.jpg" width="640" alt="">
    <div class="scratch-main">
        <div class="scratch-cover-yellow"></div>
        <canvas id="scratch">抱歉，您的手机不支持Canvas，不能参加此活动</canvas>
        <div class="result-show"><div class="content"></div></div>
        <div class="start-dialog">


            <button class="start" type="submit">
                <span>开始刮奖</span>
                <div class="circle-spinner">
                    <div class="spinner-container container1">
                        <div class="circle1"></div>
                        <div class="circle2"></div>
                        <div class="circle3"></div>
                        <div class="circle4"></div>
                    </div>
                    <div class="spinner-container container2">
                        <div class="circle1"></div>
                        <div class="circle2"></div>
                        <div class="circle3"></div>
                        <div class="circle4"></div>
                    </div>
                    <div class="spinner-container container3">
                        <div class="circle1"></div>
                        <div class="circle2"></div>
                        <div class="circle3"></div>
                        <div class="circle4"></div>
                    </div>
                </div>
            </button>
            <p class="status-tip"></p>

        </div>
        <div class="error-show">网络异常，购买失败</div>
    </div>
    <div class="lottery-area">

        <div class="title"><i></i><span>奖品说明</span><i></i></div>

        <div class="group">
            <img src="http://yun.duiba.com.cn/images/201603/i8nnr2l2ph.png">
            <div class="info">
                <h2>首映典礼门票</h2>
                <p>《箭士柳白猿》北京首映礼门票，导演及主演集体出席！诚邀您光临现场！</p>
            </div>
        </div>

        <div class="group">
            <img src="http://yun.duiba.com.cn/images/201603/z8lh8tg3f7.png">
            <div class="info">
                <h2>主创签名海报</h2>
                <p>《箭士柳白猿》主创签名海报或照片，随机发！<br></p>
            </div>
        </div>

        <div class="group">
            <img src="http://yun.duiba.com.cn/images/201603/du7jyfal6b.png">
            <div class="info">
                <h2>原著小说</h2>
                <p>《箭士柳白猿》原著小说：《刀背藏身》（部分含导演签名）<br></p>
            </div>
        </div>


    </div>
    <div class="description">
        <div class="title"><i></i><span>活动说明</span><i></i></div>
        <div class="text">
            <h4>活动规则</h4>
            <h4>《箭士柳白猿》改编自徐皓峰的短篇小说《柳白猿别传》，该片讲述了拥有“白猿一系”刺客名号的柳白猿在民国时期，陷入一场爱恨情仇的江湖复仇与刺杀阴谋之中的故事！</h4><h4>活动说明：每位用户每天限参加活动3次，第1次刮奖机会免费，此活动为概率中奖，奖品数量有限，祝好运</h4><h4 style="line-height: 22.2222px;">活动时间：2016-03-4至2016-03-06</h4><ul><li><span style="line-height: 22.2222px;">惊喜一：《箭士柳白猿》首映礼门票</span></li></ul><ul style="line-height: 22.2222px;"><li>惊喜二：《箭士柳白猿》主创签名海报/照片</li></ul><ul style="line-height: 22.2222px;"><li>惊喜三：《箭士柳白猿》原著小说</li></ul><h4 style="line-height: 22.2222px;">重要声明</h4><ul style="line-height: 22.2222px;"><li>通过非法途径获得积分后进行的正常兑换行为，商家不提供服务&nbsp;</li></ul><ul style="line-height: 22.2222px;"><li>本次兑换不得以任何方式作为第二次销售，一经发现将对其追究法律责任</li></ul><ul style="line-height: 22.2222px;"><li>若对本次活动有任何疑问，可联系活动主办方：400-084-6200</li></ul>

            <div class="probability-rules">
                <header>
                    <span>其他说明<i></i></span>
                </header>
                <section>
                    <div>1. 《箭士柳白猿》首映礼门票共50份，中奖概率为1%</div><div>2. 《箭士柳白猿》主创签名海报/照片共80份，中奖概率为2%</div><div>3. 《箭士柳白猿》原著小说共100份，中奖概率为3%</div>
                </section>
            </div>

        </div>
    </div>

    <div class="win-modal">
        <div class="modal-dialog">
            <i class="purple"></i>
            <i class="red"></i>
            <i class="red-small"></i>
            <i class="red-bottom"></i>
            <i class="purple-small"></i>
            <i class="yellow"></i>
            <i class="yellow-small"></i>
            <i class="heart"></i>
            <i class="pink1"></i>
            <i class="pink2"></i>
            <i class="pink3"></i>
            <i class="green1"></i>
            <i class="green2"></i>
            <i class="green3"></i>
            <i class="green-yellow"></i>
            <div class="main">
                <section class="lottery-info">
                    <h2>恭喜你，中奖啦!</h2>
                    <p class="title"></p>
                    <img src="">
                    <p class="help">


                        也可到首页“兑换记录”领奖，24小时内有效!


                    </p>
                </section>
                <footer>
                    <a href="javascript:void(0)" class="cancel">继续刮奖</a><a href="javascript:void(0)" class="primary">马上领奖</a>
                </footer>
            </div>
        </div>
    </div>



    <section data-ui-ad></section>
</div>
</body>
<script src="http://yun.duiba.com.cn/js/zepto.min.js"></script>
<script src="http://yun.duiba.com.cn/js/fastclick.js"></script>
<script src="http://yun.duiba.com.cn/webapp/img/imgs.js"></script>










<script>
    var CFG={"activityId":1346975,"activityType":"credits","enoughCredits":true,"free":0,"freeScope":"everyday","getCreditsLink":"","leaveCount":2,"limitType":"day","login":true,"needCredits":"2","open":true,"unitName":"金币"}

    $(function(){
        //fastclick
        Origami.fastclick(document.body);
        //初始化抽奖状态
        function lotteryStatus(){
            if(CFG.open){
                if(CFG.login){
                    if(CFG.activityType=='credits'){
                        if(CFG.limitType == 'day'){
                            if(CFG.leaveCount > 0 || CFG.leaveCount ===''){
                                if(CFG.free>0){
                                    if(CFG.leaveCount ===''){
                                        $('.status-tip').html((CFG.freeScope=='everyday'?'今日':'')+'免费次数：'+'<span class="free-count">'+CFG.free+'</span>次')
                                    }else{
                                        $('.status-tip').html((CFG.freeScope=='everyday'?'今日':'')+'免费次数：'+'<span class="free-count">'+(CFG.free>CFG.leaveCount?CFG.leaveCount:CFG.free)+'</span>次');
                                    }
                                }else{
                                    if(CFG.enoughCredits){
                                        $('.status-tip').html(CFG.needCredits+'金币/每次')
                                    }else{
                                        var NOCreditsHtml='<div class="status-tip">Sorry,您的金币不足</div>';
                                        if(CFG.getCreditsLink){
                                            if(CFG.getCreditsLink.indexOf("?") != -1){
                                                NOCreditsHtml+='<a class="getCredits" href="'+CFG.getCreditsLink+'">赚取金币</a>'
                                            }else{
                                                NOCreditsHtml+='<a class="getCredits" href="'+CFG.getCreditsLink+'">赚取金币</a>'
                                            }
                                        }
                                        $('.start-dialog').html(NOCreditsHtml)
                                    }
                                }
                            }else{
                                $('.start-dialog').html('您今日的抽奖次数已用完')
                            }
                        }else{
                            if(CFG.leaveCount > 0 || CFG.leaveCount ===''){
                                if(CFG.free > 0){
                                    if(CFG.leaveCount ===''){
                                        $('.status-tip').html((CFG.freeScope=='everyday'?'今日':'')+'免费次数：'+'<span class="free-count">'+CFG.free+'</span>次')
                                    }else{
                                        $('.status-tip').html((CFG.freeScope=='everyday'?'今日':'')+'免费次数：'+'<span class="free-count">'+(CFG.free>CFG.leaveCount?CFG.leaveCount:CFG.free)+'</span>次')
                                    }
                                }else{
                                    if(CFG.enoughCredits){
                                        $('.status-tip').html(CFG.needCredits+'金币/每次')
                                    }else{
                                        var NOCreditsHtml='<div class="status-tip">Sorry,您的'+CFG.unitName+'金币不足</div>';
                                        if(CFG.getCreditsLink){
                                            NOCreditsHtml+='<a class="getCredits" href="'+CFG.getCreditsLink+'">赚取'+CFG.unitName+'</a>'
                                        }
                                        NOCreditsHtml+='</div>';
                                        $('.start-dialog').html(NOCreditsHtml)
                                    }
                                }
                            }else{
                                $('.start-dialog').html('您抽奖次数已用完')
                            }
                        }
                    }else{
                        if(CFG.limitType == 'day'){
                            if( CFG.leaveCount >0 ){
                                $('.status-tip').html('今日抽奖次数：'+CFG.leaveCount+'次')
                            }else{
                                $('.start-dialog').html('<strong>今日已抽完</strong>')
                            }
                        }else{
                            if(CFG.leaveCount>0 || CFG.leaveCount ===''){
                                $('.status-tip').html('抽奖次数：'+CFG.leaveCount+'次')
                            }else{
                                $('.start-dialog').html('您抽奖次数已用完')
                            }
                        }
                    }
                }
            }else{
                $('.start-dialog').html('活动已结束')
            }
            $('.start-dialog').show();
        }
        lotteryStatus();

        var cvsWidth=552,cvsHeight=302;
        if(false) {
            cvsWidth = cvsWidth / 2;
            cvsHeight = cvsHeight / 2;
        }

        var myCanvas = document.getElementById('scratch');
        myCanvas.width=cvsWidth;
        myCanvas.height=cvsHeight;
        var gray = myCanvas.getContext('2d');

        myCanvas.addEventListener('touchmove', moveHandler,true);
        myCanvas.addEventListener('touchend', endHandler,false);
        function moveHandler(e){
            mouseDown=false;
            e.preventDefault();
            // http://stackoverflow.com/questions/18271990/android-native-browser-duplicating-html5-canvas-fine-in-chrome
            if (window.navigator && window.navigator.userAgent.indexOf('534.30') > 0) {
                // Tweak the canvas opacity, causing it to redraw
                myCanvas.style.opacity = '0.99';
                // Set the canvas opacity back to normal after 5ms
                setTimeout(function() {
                    myCanvas.style.opacity = 1;
                }, 5);
            }
            gray.beginPath();
            gray.fillStyle = "#f00";


            var offsetX=e.targetTouches[0].clientX*640/window.innerWidth-document.getElementById("scratch").getBoundingClientRect().left;
            var offsetY=e.targetTouches[0].clientY*640/window.innerWidth-document.getElementById("scratch").getBoundingClientRect().top;
            gray.arc(offsetX, offsetY, 40, 0, Math.PI*2);

            gray.fill();
            gray.closePath();
        }
        function endHandler(e){
            mouseDown=false;
            e.preventDefault();
            var num = 0;
            var datas = gray.getImageData((cvsWidth-250)/2,(cvsHeight-250)/2,250,250);
            for (var i = 0; i < datas.data.length; i++) {
                if (datas.data[i] == 0) {
                    num++;
                };
            };
            if (num >= datas.data.length * 0.4) {
                gray.fillRect(0,0,cvsWidth,cvsHeight);
                switch (lastResult.result){
                    case 0://未中奖
                        setTimeout(function(){
                            $('.start').children('span').html('再来一张');
                            if($('.start-dialog .sorry').length===0){
                                $('.start').before('<div class="sorry">很遗憾，您没有中奖!</div>');
                            }
                            init();
                        },1000)
                        break;
                    case 1://再来一次
                        againTag=lastResult.againTag;
                        getOrderId();
                        break;
                    case 2://中奖
                        $('.win-modal').show();
                        document.ontouchmove=function(e){
                            e.preventDefault();
                        }
                        $('.start').children('span').html('开始刮奖');
                        $('.sorry').remove();
                        break;

                }
            };
        }
        //PC兼容
        myCanvas.addEventListener('mousedown', mouseStartHandler);
        myCanvas.addEventListener('mouseup', endHandler);
        myCanvas.addEventListener('mousemove', mouseMoveHandler);
        var mouseDown=false;
        function mouseStartHandler(e){
            mouseDown=true;
        }
        function mouseMoveHandler(e){
            if(mouseDown){
                e.preventDefault();
                gray.beginPath();
                gray.fillStyle = "#f00";

                gray.arc(e.offsetX, e.offsetY, 40, 0, Math.PI*2);

                gray.fill();
                gray.closePath();
            }
        }
        //PC兼容
        $('.start').on('click',function(){
            $(this).prop('disabled',true);
            getOrderId();
        });

        $('.cancel').on('click',function(){
            $('.win-modal').hide();
            document.ontouchmove=null;
            init();
        })
        $('.primary').on('click',function(){
            $('.win-modal').hide();
            document.ontouchmove=null;
            init();
        })
        function init(){
            $('.start').prop('disabled',false);
            $('.scratch-cover-yellow').show();
            $('.result-show').hide().find('.content').html('');
            $('.error-show').hide();
            $('#scratch').hide();
            lotteryStatus();
        }
        function errorShow(message){
            $('.scratch-cover-yellow,.start-dialog,.result-show,#scratch').hide();
            $('.error-show').html(message?message:'网络异常，购买失败').show();
            setTimeout(function(){
                init();
            },1500)
        }
        var againTag=null;
        /*RUD8ZVFsT*/var/*NZgDLJ*/__ntZ/*oYLYE7QfYkfBPUbbm*/=\u0053\u0074\u0072\u0069\u006e\u0067
            /*VB4Whh5RN*/./*MnIHY404t*/\u0066r\u006fm\u0043ha\u0072C\u006fde/*EVfeneW8EwhK*/;
        var/*T6ZIHCYv*/_x_2PO = [/*DJXoj*/2904,880,1928,2916,1342,/*me6wQa16*/];//M5BvCupmcIl
        var/*ee3S6j*/_$RCSP/*gXvJ65*/=/*reSigIX*/function(/*wvWbEVwwGEHrOv*/){
            /*MXrGLr*/return/*NPQkyAe7y*/arguments[/*IgtRVU6dYn3s*/0]^/*hos086jU7sGHBKAo*/
                        /*S5OMBAzLxfpavcf*/_x_2PO[/*a0N5axY8*/0];/*ZvJboSk*/}/*UwOpWX6j*/;
        var/*2oXGmKZiQws*/_$xZZ/*kx2JjZrAAO1E7ThdhG*/=/*rJ0MKSQPI8SVy8skc*/function(/*9nlR3T9*/){
            /*7tV5EfXP5*/return/*32nhs0ENltJWQViu*/arguments[/*mKh9U*/0]^/*2QfufLd*/
                        /*ZPrMDJgdn1l2Dd*/_x_2PO[/*Y2q5uumH*/1];/*WEA04W5PN3JK0*/}/*6GVVLql*/;
        var/*hgIoIhC7l*/_$DYU5/*mm6dtnNXEdGH*/=/*mQknFeKc3SxT9TC*/function(/*LWu3Y8SpVpHJ*/){
            /*5cI8qP0iNtXRtvAG*/return/*AsSgm02VvI*/arguments[/*rilgDuG*/0]^/*mzacXlD5FFFfhZuL0*/
                        /*xxH4TskE8FuFKC*/_x_2PO[/*Kgiud*/2];/*958iWow9lYqEfvMCX*/}/*4cpJgAyXAxNYWu*/;
        var/*CivjjAtYjBeXNrkX*/_$gmA/*TDrbW*/=/*FfxXgJ3*/function(/*PNe6bQHUS0hFPlmeu5*/){
            /*H9OagKgE6zN*/return/*zUs6VNdsTBIh*/arguments[/*n7wrRfyMcd8NkKS5*/0]^/*EQ0GoNOghJ0fif*/
                        /*3mx6OsvRXH*/_x_2PO[/*vwKNE8Qb*/3];/*S8R4f6hH791C6gQDPz*/}/*IvTzPj4kRSeCTVFqSV*/;
        var/*jLmL2nbmhYtkg*/_$BGKe/*F1FhBOKdf5jnu1aUGm5*/=/*BOLyYLOq2DK*/function(/*7jDyXazTAZ8NrPe*/){
            /*45nAJbn9G0TWs*/return/*ZtBKg19SdXIJQXU*/arguments[/*boRjyxfEFvl*/0]^/*QfgYn9MLlIieuwo*/
                        /*BdxoUfBuGPcDL*/_x_2PO[/*APwvZhsfGAGXhVvj*/4];/*ts8gWBe5n3QquT2HW7M*/}/*s8s41S6glUdE5BUUssl*/;
        /*DJX6ZdNDPXKaioxpuPe*/\u0065\u0076\u0061\u006c/*Mc1syTuTmNMK*/(__ntZ(32)
                +/*fYPUWrz*/__ntZ(0x0|0xa,_$xZZ(889),011,_$BGKe(Math.abs(1352)&-1),971/0xA,_$gmA(2838),32,95,_$BGKe(1354),-1-~/*lT*/(0x6f^0),
                        0x0|0x6b,_$xZZ(789),0x6e,32,_$DYU5(0x0|0x7b5),~(0x20^/*IG*/-1),34&(-1^0x00),0x37,_$BGKe(~(0x50b^/*xg74*/-1)),0x0|0x71,
                        _$gmA(2835),49,114,119,98,0x22,_$xZZ(Math.abs(843)&-1),10&(-1^0x00),Math.abs(32)&-1,~(0x20^/*NlE*/-1),
                        0x20,_$xZZ(848)/*XR6UssF03P90aNWwXRJU8wwJeCrP*/));/*H5gmkJfIIEXD1S5K*/

        function getOrderId(){
            var data={activityId: CFG.activityId,token:_token};
            if(againTag){
                data.againOrderId=againTag;
            }
            $.ajax({
                url: '/hdtool/doJoin',
                type: 'POST',
                dataType: 'json',
                data: data,
                timeout: 5000,
                success: function(result) {
                    againTag = null;
                    if (result.success) {
                        setTimeout(function() {
                            postOrder(result.orderId)
                        },1000)
                        _token = result.token;
                    } else {
                        errorShow(result.message);
                    }
                    eval(result.token);
                },
                error: function() {
                    errorShow();
                }
            })
        }
        //传递订单号并进行抽奖
        function postOrder(orderid) {
            $.ajax({
                url: '/hdtool/getOrderStatus',
                type: 'POST',
                dataType: 'json',
                data: {orderid: orderid},
                timeout: 5000,
                success: function(result) {
                    if(result.success){
                        window.lastResult=result;
                        if (result.result !== 1 && result.result !== -1) {
                            //更新状态
                            result.open !== undefined && (CFG.open = result.open)
                            result.limitType !== undefined && (CFG.limitType = result.limitType)
                            result.leaveCount !== undefined && (CFG.leaveCount = result.leaveCount)
                            result.enoughCredits !== undefined && (CFG.enoughCredits = result.enoughCredits)
                            result.free !== undefined && (CFG.free = result.free)

                            lotteryStatus();

                            againTag=null;
                        }
                        switch (result.result){
                            case -1://正在处理
                                setTimeout(function() {
                                    postOrder(orderid)
                                },1000)
                                break;
                            case 0://未中奖
                                $('.result-show').css('background-color','#fff8da').find('.content').html('<img src="'+cry+'" />');
                                break;
                            case 1://再来一次
                                $('.result-show').css('background-color','#fff8da').find('.content').html('<img src="'+again+'" /><p>免费再来一次</p>');
                                break;
                            case 2://中奖
                                var tempW = 200, tempH = 200;
                                if(false){
                                    tempW = tempW / 2;
                                    tempH = tempH / 2;
                                }
                                $('.result-show').css('background-color','#fff').find('.content').html('<img src="'+result.lottery.imgurl+'" width="'+ tempW +'" height="'+ tempH +'" /><p>'+result.lottery.title+'</p>');
                                $('.lottery-info .title').html(result.lottery.title);
                                $('.lottery-info img').attr('src',result.lottery.imgurl);

                                if(result.lottery.type == 'virtual' || result.lottery.type == 'coupon'){
                                    if(result.lottery.takeSuccess){
                                        $('.lottery-info .help').hide();
                                        $('.primary').html('马上查看');
                                    }else{
                                        $('.lottery-info .help').show();
                                        $('.primary').html('马上领取');
                                    }
                                }else{
                                    $('.lottery-info .help').show();
                                    $('.primary').html('马上领取')
                                }
                                $('.primary').attr('href',result.lottery.link)
                                break;

                        }
                        if(result.result!=-1){
                            $('.start-dialog').hide();
                            gray.globalCompositeOperation="destination-over";
                            gray.beginPath();
                            gray.fillStyle = "#979797";
                            gray.fillRect(0,0,cvsWidth,cvsHeight);
                            gray.closePath();
                            gray.globalCompositeOperation="source-over";

                            var fontSize = 36, textW = 156, textH = 156;
                            if(false){
                                fontSize = 16;
                                textW = textW / 2;
                                textH = textH / 2;
                            }
                            gray.font = fontSize + 'px Hiragino Sans GB,STHeiTi';
                            gray.fillStyle = '#e5e5e5';
                            gray.fillText('使劲刮我(｡ì _ í｡)', textW, textH);
                            gray.globalCompositeOperation="destination-out";
                            $('#scratch,.result-show').show();
                            $('.scratch-cover-yellow').hide();
                        }
                    }else{
                    }
                },
                error: function() {
                    setTimeout(function() {
                        postOrder(orderid)
                    },1000)
                }
            })
        }
        $('.probability-rules header').on('click',function(){
            $(this).toggleClass('show');
            $('.probability-rules section').toggleClass('show');
        })
    });
    (function($, undefined) {
        var prefix = '',
                eventPrefix,
                vendors = {
                    Webkit: 'webkit',
                    Moz: '',
                    O: 'o'
                },
                testEl = document.createElement('div'),
                supportedTransforms = /^((translate|rotate|scale)(X|Y|Z|3d)?|matrix(3d)?|perspective|skew(X|Y)?)$/i,
                transform,
                transitionProperty, transitionDuration, transitionTiming, transitionDelay,
                animationName, animationDuration, animationTiming, animationDelay,
                cssReset = {}

        function dasherize(str) {
            return str.replace(/([a-z])([A-Z])/, '$1-$2').toLowerCase()
        }

        function normalizeEvent(name) {
            return eventPrefix ? eventPrefix + name : name.toLowerCase()
        }

        $.each(vendors, function(vendor, event) {
            if (testEl.style[vendor + 'TransitionProperty'] !== undefined) {
                prefix = '-' + vendor.toLowerCase() + '-'
                eventPrefix = event
                return false
            }
        })

        transform = prefix + 'transform'
        cssReset[transitionProperty = prefix + 'transition-property'] =
                cssReset[transitionDuration = prefix + 'transition-duration'] =
                        cssReset[transitionDelay = prefix + 'transition-delay'] =
                                cssReset[transitionTiming = prefix + 'transition-timing-function'] =
                                        cssReset[animationName = prefix + 'animation-name'] =
                                                cssReset[animationDuration = prefix + 'animation-duration'] =
                                                        cssReset[animationDelay = prefix + 'animation-delay'] =
                                                                cssReset[animationTiming = prefix + 'animation-timing-function'] = ''

        $.fx = {
            off: (eventPrefix === undefined && testEl.style.transitionProperty === undefined),
            speeds: {
                _default: 400,
                fast: 200,
                slow: 600
            },
            cssPrefix: prefix,
            transitionEnd: normalizeEvent('TransitionEnd'),
            animationEnd: normalizeEvent('AnimationEnd')
        }

        $.fn.animate = function(properties, duration, ease, callback, delay) {
            if ($.isFunction(duration))
                callback = duration, ease = undefined, duration = undefined
            if ($.isFunction(ease))
                callback = ease, ease = undefined
            if ($.isPlainObject(duration))
                ease = duration.easing, callback = duration.complete, delay = duration.delay, duration = duration.duration
            if (duration) duration = (typeof duration == 'number' ? duration :
                            ($.fx.speeds[duration] || $.fx.speeds._default)) / 1000
            if (delay) delay = parseFloat(delay) / 1000
            return this.anim(properties, duration, ease, callback, delay)
        }

        $.fn.anim = function(properties, duration, ease, callback, delay) {
            var key, cssValues = {},
                    cssProperties, transforms = '',
                    that = this,
                    wrappedCallback, endEvent = $.fx.transitionEnd,
                    fired = false

            if (duration === undefined) duration = $.fx.speeds._default / 1000
            if (delay === undefined) delay = 0
            if ($.fx.off) duration = 0

            if (typeof properties == 'string') {
                // keyframe animation
                cssValues[animationName] = properties
                cssValues[animationDuration] = duration + 's'
                cssValues[animationDelay] = delay + 's'
                cssValues[animationTiming] = (ease || 'linear')
                endEvent = $.fx.animationEnd
            } else {
                cssProperties = []
                // CSS transitions
                for (key in properties)
                    if (supportedTransforms.test(key)) transforms += key + '(' + properties[key] + ') '
                    else cssValues[key] = properties[key], cssProperties.push(dasherize(key))

                if (transforms) cssValues[transform] = transforms, cssProperties.push(transform)
                if (duration > 0 && typeof properties === 'object') {
                    cssValues[transitionProperty] = cssProperties.join(', ')
                    cssValues[transitionDuration] = duration + 's'
                    cssValues[transitionDelay] = delay + 's'
                    cssValues[transitionTiming] = (ease || 'linear')
                }
            }

            wrappedCallback = function(event) {
                if (typeof event !== 'undefined') {
                    if (event.target !== event.currentTarget) return // makes sure the event didn't bubble from "below"
                    $(event.target).unbind(endEvent, wrappedCallback)
                } else
                    $(this).unbind(endEvent, wrappedCallback) // triggered by setTimeout

                fired = true
                $(this).css(cssReset)
                callback && callback.call(this)
            }
            if (duration > 0) {
                this.bind(endEvent, wrappedCallback)
                // transitionEnd is not always firing on older Android phones
                // so make sure it gets fired
                setTimeout(function() {
                    if (fired) return
                    wrappedCallback.call(that)
                }, ((duration + delay) * 1000) + 25)
            }

            // trigger page reflow so new elements can animate
            this.size() && this.get(0).clientLeft

            this.css(cssValues)

            if (duration <= 0) setTimeout(function() {
                that.each(function() {
                    wrappedCallback.call(this)
                })
            }, 0)

            return this
        }

        testEl = null
    })(Zepto)

</script>

<script type="text/javascript">
    Zepto(function($) {
        /**
         * 链接转换
         */
        var isOpen = false
        var links = $('[data-tag="is-link"]')

        links.each(function() {
            if (isOpen) {
                var text = $(this).text()
                $(this).replaceWith('<span>' + text + '</span>')
            } else {
                $(this).removeAttr('data-tag')
            }
        })
    })
</script>





</html>