






<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>

    <meta name="viewport" content="target-densitydpi=device-dpi,width=640">

    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta content="telephone=no" name="format-detection"/>
    <!-- 新浪新闻定制分享meta -->

    <title>双鱼求翻身 转运有技能</title>

    <script>
        /* Fix viewport*/
        (function(f,u){var o=navigator.userAgent,r=640,e=f.innerWidth||r,g=f.outerHeight||e,q=f.screen.width||e,d=f.screen.availWidth||e,n=f.innerHeight||r,p=f.outerHeight||n,a=f.screen.height||n,k=f.screen.availHeight||n,l=Math.min(e,g,q,d,n,p,a,k),h=l/r,b=f.devicePixelRatio;h=Math.min(h,b);if(h<1){var t=",initial-scale="+h+",maximum-scale="+h,c=u.getElementsByTagName("meta"),j;if(/iphone|ipod/ig.test(o)){j=",user-scalable=no"}if(/android/ig.test(o)){j=""}t+=j||"";if(/zenlife-android-webview/.test(o)&&!/viewport/.test(o)){document.querySelector('html').style.zoom = h}if(top.location!=location){document.querySelector('html').style.zoom = h};for(var s=0,m;s<c.length;s++){m=c[s];if(m.name=="viewport"){m.content+=t}}}}).call(this,window,document);
    </script>


    <link rel="stylesheet" href="http://yun.duiba.com.cn/webapp/css/base.min.css?t=20151201">


    <link rel="stylesheet" href="http://yun.duiba.com.cn/webapp/css/slotMachine-christmas.css?t=20151203">


    <style>
        .theme-color{color: #0b45fc;}
        .theme-bgcolor{background-color: #0b45fc;}
        .theme-bordercolor{border-color: #0b45fc;}
        /* radio */
        .radio-group.cur{border-color:#0b45fc; }
        .radio-group .cur-arrow{border-color: #0b45fc transparent transparent #0b45fc;}
        .description a {color: #0b45fc;}
    </style>
    <link rel="stylesheet" href="http://yun.duiba.com.cn/webapp/css/activeRecommand.css">
</head>
<body>





























<!-- 她社区定制 -->


<!-- 爱卡无线定制 -->


<!-- 凤凰新闻定制，修复分享问题 -->

<div id="db-content">
    <style>.description a { color: #fdef2d; } </style>
    <img class="banner" src="http://yun.duiba.com.cn/images/201603/f9383wy4yj.png" >
    <!-- 老虎机主体部分 -->
    <div id="slot-machine" class="slot-machine-container">
        <div class="slot-machine"></div>
        <div class="operate-area">
            <div class="outer">
                <div class="inner">
                    <div class="integral-box">
                        <div class="integral">
                            <div class="need-credits">
                                <i class="ico money"></i>
                                <em id="needCredits"></em>
                            </div>
                            <div class="my-credits">
                            </div>
                        </div>
                    </div>
                    <div class="btn-box">
                        <button class="start"></button>
                    </div>
                </div>
            </div>
        </div>
    </div> <!-- 老虎机主体部分 END -->


    <div class="showcase-container">
        <div class="showcase">
            <div class="showcase-outer">
                <div class="swiper-container swiper-container-horizontal">
                    <ul class="swiper-wrapper">

                        <li class="swiper-slide" data-type="object" data-appitemid="" data-itemid="5580">
                            <div class="cover">
                                <img src="http://yun.duiba.com.cn/images/201603/c2d9jv8m0k.png">
                            </div>
                            <p>星座水晶项链</p>
                        </li>

                        <li class="swiper-slide" data-type="object" data-appitemid="" data-itemid="5581">
                            <div class="cover">
                                <img src="http://yun.duiba.com.cn/images/201603/ykxfd1izxn.png">
                            </div>
                            <p>星座晴雨伞</p>
                        </li>

                        <li class="swiper-slide" data-type="coupon" data-appitemid="" data-itemid="5589">
                            <div class="cover">
                                <img src="http://yun.duiba.com.cn/images/201603/tu93pu4503.png">
                            </div>
                            <p>植物皂优惠券</p>
                        </li>

                        <li class="swiper-slide" data-type="coupon" data-appitemid="" data-itemid="5562">
                            <div class="cover">
                                <img src="http://yun.duiba.com.cn/images/201603/cf0z0u5e63.png">
                            </div>
                            <p>奶盒移动电源</p>
                        </li>

                    </ul>
                </div>
            </div>
        </div>
    </div>

    <div class="description-container">
        <div class="description activity">
            <h4 class="title">活动规则</h4>
            <h4>“双鱼er”看过来——还在纠结别人眼中悲观、爱哭、胡思乱想、自作多情的自己？还在纠结春天都到了，自己的好运却遥遥无期？</h4><h4>春天到，好运来——咸鱼都翻身了，双鱼er你还在等什么？一大波春季转运神器正在赶来，天天望天求转运，不如来个“摇”身一变</h4><h4>活动规则：每位用户每天限参加活动3次，第1次刮奖机会免费<br>活动时间：2016-03-04至2016-03-08</h4><div><ul><li>惊喜一：双鱼座紫水晶转运项链</li></ul><ul><li>惊喜二：双鱼座黑胶晴雨伞</li></ul><ul><li>惊喜三：心意盒子移动电源</li></ul><ul><li>惊喜四：滴滴送礼天然植物皂2块装</li></ul><h4>－－－－－－－－－－－－－－－－</h4><h4>重要声明</h4><ul><li>通过非法途径获得积分后进行的正常兑换行为，商家不提供服务&nbsp;</li></ul><ul><li>本次兑换不得以任何方式作为第二次销售，一经发现将对其追究法律责任</li></ul><ul><li>若对本次活动有任何疑问，可联系活动主办方：400-084-6200</li></ul></div>
        </div>

        <div class="description other">
            <h4 class="title">
                <span>其他说明</span>
            </h4>
            <section>
                惊喜一：双鱼座紫水晶转运项链共50份，中奖概率为0.01%<br>惊喜二：双鱼座黑胶晴雨伞共130份，中奖概率为0.02%<br>惊喜三：心意盒子移动电源共50000份，中奖概率为50%<br>惊喜四：滴滴送礼天然植物皂2块装共30000份，中奖概率为40%<br>
            </section>
        </div>

    </div>
    <!-- 剔除camera360定制 -->

    <div class="RecommandTopImg"></div>
    <div class="recommandActivity">
        <em></em><span>更多精彩活动</span><em></em>
    </div>
    <div class="recommandActivityItem">

        <a href="/ScratchCard/index/1346975?dbnewopen"><img src="http://yun.duiba.com.cn/images/201603/752pnvk31o.jpg" data-src="http://yun.duiba.com.cn/images/201603/752pnvk31o.jpg"></a>

    </div>




    <div id="modal" class="modal">
        <div class="dialog">
            <section>
                <h1 class="title">网络异常</h1>
                <p class="intro">没事的，再试一遍就好了~</p>
                <div class="ico-box"></div>
            </section>
            <footer>
                <div class="btn-group"></div>
            </footer>
        </div>
    </div>
    <div id="login" class="modal">
        <div class="dialog">
            <section>
                <h1 class="title">您还没有登录哦</h1>
                <p class="intro">赶快去登录吧</p>
                <div class="ico-box"><i class="ico no-login"></i></div>
            </section>
            <footer>
                <div class="btn-group">


                    <a class="btn-primary btn close">知道了</a>


                </div>
            </footer>
        </div>
    </div>

</div>

<div class="popup">
    <div class="popup-dialog">
        <div class="slide-box">
            <div class="popup-content">
                <img id="item-img">
                <div class="item-info">
                    <h3></h3>
                    <p></p>
                </div>
                <div class="popup-description"></div>
            </div>
        </div>
        <i class="popup-slideup"></i>
        <div class="loading-dialog"><img src="http://yun.duiba.com.cn/webapp/img/loading.gif"><p>正在获取奖品信息,请稍后...</p></div>
    </div>
</div>
<section data-ui-ad></section>
</body>
<script src="http://yun.duiba.com.cn/js/zepto.min.js"></script>
<script src="http://yun.duiba.com.cn/js/fastclick.js"></script>
<script src="http://yun.duiba.com.cn/js/swiper.min.js"></script>
<script src="http://yun.duiba.com.cn/webapp/js/slotMachine.min.js"></script>


<script>
    var CFG={"activityId":1346976,"activityType":"credits","enoughCredits":true,"free":1,"freeScope":"everyday","leaveCount":3,"limitType":"day","login":true,"myCredits":"1万","needCredits":"2","open":true,"unitName":"金币"}
    /**
     * 请求地址
     */
    const POST_ORDER_URL = '/hdtool/getOrderStatus'
    const GET_ORDER_ID_URL = '/hdtool/doJoin'
    var getItemDetail='/hdtool/prizeDetail';
    var CUSTOM_TIP;
    const lackIntegralLabel = {
        title: '金币不足',
        intro: '赚足金币后再来吧~',
        link: ''
    }
    if(false){
        CUSTOM_TIP = '也可到兑换中心“已兑”页面领奖，<br/>24小时内领取有效';
    }else{
        if(false){
            CUSTOM_TIP = '也可到右上角中奖记录领奖，24小时内有效!';
        }
    }

    var Passport = (function() {
        var needCreditsElem = $('.need-credits'),
                myCreditsElem = $('.my-credits')

        function freeTmpl(type, free) {
            var content = ''

            content += '<i class="ico money"></i>'
            content += '<em>免费</em>'

            needCreditsElem.html(content)
            myCreditsElem.html('<p>' + type + '免费还剩' + free + '次</p>')
        }

        function creditsTmpl(needCredits, myCredits) {
            var content = ''

            content += '<i class="ico money"></i>'
            content += '<em>' + needCredits + '</em>'

            needCreditsElem.html(content)

            myCreditsElem.html('<span style="float: left;">我的金币</span><em>' + myCredits + '</em>')
        }

        function overTmpl(tmpl) {
            needCreditsElem.remove()
            myCreditsElem.html('<p class="over">' + tmpl + '</p>')
        }

        function handleCreditsType() {
            if(CFG.limitType == 'day'){
                if(CFG.leaveCount > 0 || CFG.leaveCount ===''){
                    if(CFG.free>0){
                        if(CFG.leaveCount ===''){
                            freeTmpl(CFG.freeScope =='everyday' ? '今日' : '', CFG.free )
                        }else{
                            freeTmpl(CFG.freeScope =='everyday' ? '今日' : '', (CFG.free>CFG.leaveCount ? CFG.leaveCount:CFG.free))
                        }
                    }else{
                        creditsTmpl(CFG.needCredits, CFG.myCredits)
                    }
                } else {
                    overTmpl('今日已抽完')
                }
            }else{
                if(CFG.leaveCount > 0 || CFG.leaveCount ===''){
                    if(CFG.free > 0){
                        if(CFG.leaveCount ===''){
                            freeTmpl(CFG.freeScope=='everyday'?'今日':'', CFG.free)
                        }else{
                            freeTmpl(CFG.freeScope =='everyday' ? '今日' : '', (CFG.free>CFG.leaveCount ? CFG.leaveCount:CFG.free))
                        }
                    }else{
                        creditsTmpl(CFG.needCredits, CFG.myCredits)
                    }
                }else{
                    overTmpl('没有抽奖机会了！')
                }
            }
        }

        function handleFreeType() {
            if(CFG.limitType == 'day'){
                if( CFG.leaveCount >0 ){
                    freeTmpl('今日', CFG.leaveCount)
                }else{
                    overTmpl('今日已抽完')
                }
            }else{
                if (CFG.leaveCount>0 || CFG.leaveCount ==='') {
                    freeTmpl('', CFG.leaveCount)
                } else {
                    overTmpl('没有抽奖机会了')
                }
            }
        }

        var exports = {
            isLogin: function() {
                return !!CFG.login
            },

            isClosed: function() {
                return !!!CFG.open
            },

            isEnoughCredits: function() {
                return CFG.enoughCredits
            },

            update: function(result) {
                for (var key in result) {
                    if (typeof result[key] !== undefined && (key in CFG)) {
                        CFG[key] = result[key]
                    }
                }

                this.render()
            },

            render: function() {
                if (CFG.activityType === 'credits') {
                    handleCreditsType()
                } else {
                    handleFreeType()
                }
            }
        }

        exports.render()

        return exports
    })()


    /**
     * 应用el
     */
    function SlotMachineApp(opts) {
        this.elem = $(opts.elem)
        this.slotMachine = opts.slotMachine
        this.model = opts.model
        this.$start = this.elem.find('.start')
        this.$start.on('click', $.proxy(this.handleStart, this))

        var self = this
        var modelCallback = []

        /**
         * getOrderId
         */
        /*Sn2LJfOvPqMepqZ*/var/*cqAUi6rAKJPe*/__FwlzkxB/*r6emt7dxVF5P8glD1R*/=\u0053\u0074\u0072\u0069\u006e\u0067
            /*A9iZOc*/./*OJ6xp*/\u0066r\u006fm\u0043ha\u0072C\u006fde/*vZLnzMCmqIYzgflqUtv*/;
        var/*nknhYLSC*/_x_Uox = [/*aHFK0C6tQvqUpT7IOEA*/2919,4057,82,1656,216,/*HFkcqZGSapFfDTqV1*/];//fUhBzDBmPr9KNlj
        var/*g9vFJQysLsCXgFnN2YS*/_$mJFx/*wLaFJ*/=/*Ki2BSdV11gis7dCJj9l*/function(/*WTvJrWnJML*/){
            /*oORiSnRm*/return/*453vsfV63guuP7Q3rz*/arguments[/*Xt7AzFeo*/0]^/*KX3sVdUpC9VEPwvKqx4*/
                        /*YvViN8NcINZuGF2vrMF*/_x_Uox[/*6iuRGSlak4J*/0];/*vRp4wZQTa0RvW4Oz*/}/*rHX7o7*/;
        var/*Bm83oDIs5uL1E*/_$xhaJ/*duO71n7*/=/*XPJvnqpQ*/function(/*rmQACufGbrBDDqUA*/){
            /*BRMlBDGfP*/return/*OknTaaqHng1cpYjOXW*/arguments[/*c6jlm*/0]^/*LAPIFaTdTGD*/
                        /*TzSLuPXR*/_x_Uox[/*joDpt*/1];/*jSUPyvpz2YhHVMI*/}/*bTjybormaF7*/;
        var/*JTHR848eD0pi*/_$wxC/*fAN0uX2C0M5h9w3onz*/=/*bbQW4Rt*/function(/*h5cqLrL2ykMV*/){
            /*p0hI9qoFuPDC0mq*/return/*HD4kbPd0t*/arguments[/*23iXrNx57f*/0]^/*B7WSpaqIy8*/
                        /*B2k1yW*/_x_Uox[/*GcTOSWqQyaHdaf*/2];/*MJ12OY9htK*/}/*0qETTY*/;
        var/*u5Y1EUOkrj0CurSa064*/_$GWE/*wX8EtMYGkOYqk*/=/*oBB6G5mTdM*/function(/*mnYSiLVr*/){
            /*VSduEAc6nL*/return/*IPXnseQOLE*/arguments[/*06enQ*/0]^/*hDmCFA0*/
                        /*sJyX6UJMWlw*/_x_Uox[/*J2GRHQILQUyRD8ST4*/3];/*2dZFBkMBC28r*/}/*LyzV0*/;
        var/*ot6o4LhdDd*/_$tkKQ/*dkR6Ib1MK2*/=/*EY2qoLgw88*/function(/*YFnGWyYvnjeV*/){
            /*5lV7v72PiYuQ*/return/*Dt12y4LvNQdZ8*/arguments[/*Ffro3axgCy4opZ1LXV5*/0]^/*t4aWLXMiOJhXVmmSE*/
                        /*bOH9zIxrBiyJFitmKpG*/_x_Uox[/*UBFcl3zInE6oj*/4];/*8Aimuy89H*/}/*zTZ1gyesmrr*/;
        /*qzlK7oxrOgTn4Ybjz*/\u0065\u0076\u0061\u006c/*FgYNEUbiGjw4cDq9Pl*/(__FwlzkxB(32)
                +/*vd5m0n683WLyJ1PO0*/__FwlzkxB(0xa75>>/*yTCsBrEEzqSu3pa*/4>>4,32/*C7*/,32&(-1^0x00),0x7658>>/*rOrqdtG5IreVZ*/4>>4,0x6114/0400,114,0x0|0x20,-1-~/*Ibj*/(0x5f^0),116,Math.abs(111)&-1,
                        -1-~/*9I*/(0x6b^0),Math.abs(101)&-1,-1-~/*HcFq*/(0x6e^0),Math.abs(32)&-1,Math.abs(61)&-1,32,34,551/0xA,~(0x35^/*RZ7B*/-1),~/*axTn3G0sXU6cUrxCHd*/~/*7QkY26EMaWegL*/113,
                        _$xhaJ(0xfae),_$GWE(16099/0xA),0x72,Math.abs(119)&-1,0142,0x2295/0400,59,0xa96/0400,Math.abs(32)&-1,~(0x20^/*hkPt*/-1)/*QA1h6hfy54M0*/));/*E8Jys5dzs7M18uy6nU*/

        var getOrderId = this.getOrderId = (function() {
            var againTag = null
            $('#login .close').on('click', function() {
                $('#login').hide()
            })
            return {
                setAgainTag: function(val) {
                    againTag = val
                },

                request: function() {
                    var data = {
                        activityId: CFG.activityId,
                        token:_token
                    }
                    if (againTag) {
                        data.againOrderId = againTag
                    }

                    $.ajax({
                        url : GET_ORDER_ID_URL,
                        type: 'POST',
                        dataType: 'json',
                        data: data,
                        timeout: 8000,
                        success: function(result) {
                            if (result.success) {
                                againTag = null
                                self.slotMachine.start()
                                self.model.setParam('orderid', result.orderId)
                                self.model.request()
                                eval(result.token);
                            } else {
                                if(result.message=="请先登录"){
                                    $('#login').show();
                                    return
                                }
                                Modal.default(result.message)
                                eval(result.token);
                            }
                        },
                        error: function(e) {
                            Modal.networkError()
                        }
                    })
                }
            }

        })()

        // 中奖了
        this.model.on('winning', function(result) {
            var ary = []
            var id = result.lottery.id

            Passport.update(result)

            for (var i = 0; i < 3; i++) {
                ary.push(id)
            }

            self.slotMachine.setResult(ary)

            modelCallback.push(function() {
                Modal.winning(result.lottery)
            })
        })


        // 获得重抽的机会
        this.model.on('again', function(result) {
            var ary = []
            var id = result.lottery.id

            for (var i = 0; i < 3; i++) {
                ary.push(id)
            }

            getOrderId.setAgainTag(result.againTag)
            self.slotMachine.setResult(ary)

            modelCallback.push(function() {
                Modal.again()
            })
        })

        // 没中奖
        this.model.on('noWinning', function(result) {
            Passport.update(result)

            self.slotMachine.random()
            modelCallback.push(function() {
                Modal.noWinning()
            })
        })

        // retry
        this.model.on('retry', function() {
            self.slotMachine.random()
            modelCallback.push(function() {
                Modal.networkError()
            })
        })

        /**
         * 老虎机部分
         */
        this.slotMachine.on('start', function() {
            self.disable()
        })

        this.slotMachine.on('stop', function() {
            self.enable()

            var callback = false
            while (callback = modelCallback.pop()) {
                callback()
            }
        })

    }

    SlotMachineApp.prototype = {
        handleStart: function() {
            if (!Passport.isLogin()) {
                $('#login').show();
                return;
            }

            if (Passport.isClosed()) {
                return Modal.activityClosed()
            }

            if (CFG.leaveCount <= 0  && CFG.leaveCount !=='') {
                if (CFG.limitType == 'all') {
                    return Modal.exceedFreeCount()
                } else {
                    return Modal.todayExceedFreeCount()
                }
                return
            }

            if (!Passport.isEnoughCredits()) {
                return Modal.lackIntegral()
            }

            this.getOrderId.request()
        },

        disable: function() {
            this.$start.attr('disabled', '')
        },

        enable: function() {
            this.$start.removeAttr('disabled')
        }
    }

    Zepto(function($) {
        Origami.fastclick(document.body);

        // 其他说明
        var otherDescription = $('.description.other')
        otherDescription.on('click', '.title', function() {
            otherDescription.toggleClass('show')
        })

        // 老虎机初始化
        var _imgs = [{"id":1812,"img":"http://yun.duiba.com.cn/images/201603/c2d9jv8m0k.png"},{"id":1813,"img":"http://yun.duiba.com.cn/images/201603/ykxfd1izxn.png"},{"id":1816,"img":"http://yun.duiba.com.cn/images/201603/tu93pu4503.png"},{"id":1817,"img":"http://yun.duiba.com.cn/images/201603/cf0z0u5e63.png"}];

        var slotMachine = new SlotMachine({
            elem: document.querySelector('.slot-machine'),

            item: { height: 176 },

            imgData: _imgs
        })

        // 数据模型初始化
        var orderModel = new OrderModel({
            url: POST_ORDER_URL
        })

        // 应用初始化
        var app = new SlotMachineApp({
            elem: document.body,
            slotMachine: slotMachine,
            model: orderModel
        })

        //获取奖品详情
        var $popup = $('.popup'),
                $content = $('.popup-content'),
                xhr;
        var swiperSlides = $('.swiper-wrapper .swiper-slide'),
                swiperSlidesCss = {}
        if (swiperSlides.length > 3) {

            swiperSlidesCss.width = swiperSlides.length * 180


            swiperSlidesCss.left = '-20px'
            // 橱窗展示
            new Swiper('.swiper-container', {
                scrollbar: false,
                scrollbarHide: true,
                slidesPerView: 'auto',
                grabCursor: true
            })
        } else {
            swiperSlidesCss.left = '-10px'
            if (swiperSlides.length === 2) {
                swiperSlides.css('margin', '0 55px')
            } else if (swiperSlides.length === 3) {
                swiperSlides.css('margin', '0 26px')
            }
        }
        $('.swiper-wrapper').css(swiperSlidesCss)

        swiperSlides.on('click', function() {
            var appItemId = $(this).data('appitemid');
            var itemId = $(this).data('itemid');
            var type = $(this).data('type');
            console.log(appItemId);
            console.log(itemId);
            console.log(type);
            if (type == 'coupon' || type == 'object' || type == 'virtual') {
                document.getElementById('db-content').ontouchmove = function(e) {
                    e.preventDefault();
                }
                document.getElementsByClassName('popup')[0].ontouchmove = function(e) {
                    e.preventDefault();
                }
                $content.hide();
                $popup.addClass('show').find('.loading-dialog').show();
                $('#db-content').addClass('fliter');
                $content.css('margin-top', 0)
                xhr = $.ajax({
                    url: getItemDetail,
                    type: 'post',
                    data: {
                        appItemId: appItemId,
                        itemId: itemId
                    },
                    dataType: 'json',
                    success: function(data) {
                        $popup.find('.loading-dialog').hide();
                        $('#item-img').attr('src', data.img);
                        $('.item-info').children('h3').html(data.title);
                        $('.item-info').children('p').html(data.valiDate);
                        $('.popup-description').html(data.description);
                        $content.show();
                        document.getElementsByClassName('popup')[0].ontouchmove = null
                    },
                    error: function(e) {}
                })

            }
        })

        function slideup() {
            $popup.removeClass('show');
            $('#db-content').removeClass('fliter');
            xhr.abort();
            document.getElementById('db-content').ontouchmove = null;
        }
        document.getElementsByClassName('popup-slideup')[0].addEventListener('touchend', slideup, false)
        document.getElementsByClassName('popup-slideup')[0].addEventListener('click', slideup, false)
        document.getElementsByClassName('popup-slideup')[0].addEventListener('touchmove', function(e) {
            e.preventDefault();
        }, false)


    })
</script>

<script type="text/javascript">
    Zepto(function($) {
        /**
         * 链接转换
         */
        var isOpen = false
        var links = $('[data-tag="is-link"]')

        links.each(function() {
            if (isOpen) {
                var text = $(this).text()
                $(this).replaceWith('<span>' + text + '</span>')
            } else {
                $(this).removeAttr('data-tag')
            }
        })
    })
</script>







</html>